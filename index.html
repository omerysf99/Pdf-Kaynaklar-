<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>SpyderCoin - Firebase & Task Edition</title>
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://adexora.com/cdn/ads.js?id=1545"></script>

    <style>
        :root {
            --spyder-purple: #a855f7;
            --spyder-purple-glow: rgba(168, 85, 247, 0.45);
            --spyder-bg-black: #070708;
            --spyder-card-bg: #111113;
            --spyder-card-border: #1f1f22;
            --spyder-text-white: #ffffff;
            --spyder-text-dim: #94a3b8;
            --spyder-green: #10b981;
            --radius-xl: 28px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; user-select: none; }
        body { background-color: var(--spyder-bg-black); color: var(--spyder-text-white); font-family: 'Inter', sans-serif; overflow: hidden; width: 100vw; height: 100vh; display: flex; flex-direction: column; }

        .app-container { flex: 1; overflow-y: auto; padding-bottom: 110px; }
        .page { display: none; flex-direction: column; align-items: center; padding: 25px; animation: slideIn 0.3s ease; }
        .page.active { display: flex; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* G√ñREV KARTI */
        .task-card { background: var(--spyder-card-bg); border: 1px solid var(--spyder-card-border); border-radius: 20px; padding: 20px; width: 100%; margin-top: 15px; display: flex; justify-content: space-between; align-items: center; }
        .task-info b { display: block; font-size: 16px; }
        .task-info span { color: var(--spyder-purple); font-weight: bold; font-size: 14px; }

        .task-btn { background: var(--spyder-purple); color: white; border: none; padding: 10px 18px; border-radius: 12px; font-weight: bold; cursor: pointer; min-width: 90px; }
        .task-btn:disabled { background: #27272a; color: #71717a; cursor: not-allowed; }

        /* Dƒ∞ƒûER STƒ∞LLER (√ñnceki versiyonlarla aynƒ±) */
        .balance-amount { font-size: 60px; font-weight: 900; text-align: center; margin: 10px 0; background: linear-gradient(#fff, var(--spyder-purple)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .spider-target { width: 220px; height: 220px; background: radial-gradient(circle, #c084fc, #7c3aed); border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 90px; box-shadow: 0 0 30px var(--spyder-purple-glow); margin: 20px 0; cursor: pointer; transition: 0.05s; }
        .spider-target:active { transform: scale(0.92); }
        .navbar { position: fixed; bottom: 0; width: 100%; height: 90px; background: #0a0a0b; display: grid; grid-template-columns: repeat(5, 1fr); border-top: 1px solid #1c1c1e; padding-bottom: 20px; }
        .nav-item { display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--spyder-text-dim); font-size: 10px; cursor: pointer; }
        .nav-item.active { color: var(--spyder-purple); }
        .nav-item i { font-style: normal; font-size: 24px; }
        .energy-bar { width: 100%; height: 12px; background: #151518; border-radius: 20px; overflow: hidden; margin-top: 10px; border: 1px solid #222; }
        .energy-fill { height: 100%; background: var(--spyder-purple); transition: 0.2s; }
    </style>
</head>
<body>

    <main class="app-container">
        <section id="p-home" class="page active">
            <h1 class="balance-amount" id="ui-bal">0</h1>
            <div class="spider-target" id="spider-btn">üï∑Ô∏è</div>
            <div style="width:100%; max-width:400px; padding:20px; background:rgba(255,255,255,0.02); border-radius:20px;">
                <div style="display:flex; justify-content:space-between; font-weight:bold;">
                    <span>‚ö° ENERGY</span>
                    <span id="ui-nrg">1000/1000</span>
                </div>
                <div class="energy-bar"><div id="ui-nrg-fill" class="energy-fill"></div></div>
            </div>
        </section>

        <section id="p-tasks" class="page">
            <h2 style="align-self:flex-start;">G√∂revler</h2>
            <div class="task-card">
                <div class="task-info">
                    <b>Telegram Kanalƒ±na Katƒ±l</b>
                    <span>+111 SPYDER</span>
                </div>
                <button class="task-btn" id="tg-task-btn" onclick="startTgTask()">KATIL</button>
            </div>
        </section>

        <section id="p-vault" class="page"><h2>Vault</h2></section>
        <section id="p-wallet" class="page"><h2>C√ºzdan</h2></section>
        <section id="p-friends" class="page"><h2>Dostlar</h2></section>
    </main>

    <nav class="navbar">
        <div class="nav-item active" onclick="nav('p-home', this)"><i>üéÆ</i><span>Oyna</span></div>
        <div class="nav-item" onclick="nav('p-tasks', this)"><i>üìã</i><span>G√∂rev</span></div>
        <div class="nav-item" onclick="nav('p-vault', this)"><i>üèõÔ∏è</i><span>Vault</span></div>
        <div class="nav-item" onclick="nav('p-wallet', this)"><i>üí∞</i><span>C√ºzdan</span></div>
        <div class="nav-item" onclick="nav('p-friends', this)"><i>üë•</i><span>Dost</span></div>
    </nav>

    <script>
        // 1. FIREBASE KONFƒ∞G√úRASYONU (Burayƒ± kendi bilgilerinizle doldurun)
        const firebaseConfig = {
            apiKey: "API_KEY_BURAYA",
            authDomain: "PROJE_ID.firebaseapp.com",
            projectId: "PROJE_ID",
            storageBucket: "PROJE_ID.appspot.com",
            messagingSenderId: "SENDER_ID",
            appId: "APP_ID"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const tg = window.Telegram.WebApp;

        let state = { bal: 0, nrg: 1000, uid: "8392479231", isTaskClaimed: false }; // UID varsayƒ±lan admin veya tg id

        // 2. VERƒ∞ KAYDETME / Y√úKLEME
        async function syncData() {
            try {
                await db.collection("users").doc(state.uid).set({
                    balance: state.bal,
                    energy: state.nrg,
                    lastUpdate: firebase.firestore.FieldValue.serverTimestamp()
                }, { merge: true });
            } catch (e) { console.error("Firestore Error:", e); }
        }

        // 3. TELEGRAM G√ñREVƒ∞ (10 Saniye Kontrol√º)
        function startTgTask() {
            if(state.isTaskClaimed) return;
            
            const btn = document.getElementById('tg-task-btn');
            tg.openTelegramLink('https://t.me/SpyderCommunity'); // Kanal linkin
            
            let seconds = 10;
            btn.disabled = true;
            
            const interval = setInterval(() => {
                btn.innerText = `Kontrol (${seconds}s)`;
                seconds--;
                
                if(seconds < 0) {
                    clearInterval(interval);
                    state.bal += 111;
                    state.isTaskClaimed = true;
                    btn.innerText = "TAMAMLANDI";
                    btn.style.background = "#10b981";
                    updateUI();
                    syncData();
                    tg.showAlert("Tebrikler! 111 Spyder hesabƒ±na eklendi.");
                }
            }, 1000);
        }

        // 4. TIKLAMA VE OYUN MANTIƒûI
        function handleTap(e) {
            if (state.nrg <= 0) return;
            state.bal += 1;
            state.nrg -= 1;
            updateUI();
            tg.HapticFeedback.impactOccurred('light');
            // Her 10 tƒ±kta bir buluta yedekle (performans i√ßin)
            if(state.bal % 10 === 0) syncData();
        }

        function updateUI() {
            document.getElementById('ui-bal').innerText = state.bal.toLocaleString();
            document.getElementById('ui-nrg').innerText = `${state.nrg}/1000`;
            document.getElementById('ui-nrg-fill').style.width = (state.nrg / 10) + "%";
        }

        function nav(id, el) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            el.classList.add('active');
        }

        // Event Listeners
        const tapBtn = document.getElementById('spider-btn');
        tapBtn.addEventListener('touchstart', (e) => { e.preventDefault(); handleTap(e); });
        tapBtn.addEventListener('mousedown', (e) => { if(!('ontouchstart' in window)) handleTap(e); });

        setInterval(() => { if(state.nrg < 1000) { state.nrg++; updateUI(); } }, 1500);
        
        tg.ready();
        updateUI();
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Flappy CW - Full Version</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        
        :root {
            --primary-bg: #4eb5d3;
            --cw-brown: #9c5c3c;
            --ton-blue: #0088cc;
            --ground-green: #8bc34a;
        }

        body { 
            background-color: var(--primary-bg); 
            font-family: 'Inter', sans-serif; 
            margin: 0; overflow: hidden; user-select: none;
        }

        /* CSS Ä°LE ÅEHÄ°R SÄ°LÃœETÄ° (Imgur yerine) */
        .city-silhouette {
            position: absolute; bottom: 110px; width: 100%; height: 100px;
            background-image: 
                linear-gradient(to top, #b3e5fc 10%, transparent 100%),
                /* GÃ¶kdelen Åekilleri */
                linear-gradient(#81d4fa 0%, #81d4fa 100%),
                linear-gradient(#4fc3f7 0%, #4fc3f7 100%),
                linear-gradient(#29b6f6 0%, #29b6f6 100%);
            background-size: 100% 100%, 40px 60px, 30px 80px, 50px 40px;
            background-repeat: no-repeat;
            background-position: bottom, 20% bottom, 45% bottom, 80% bottom;
            z-index: 1; opacity: 0.6;
        }

        /* CSS Ä°LE BULUTLAR */
        .cloud {
            position: absolute; background: white; border-radius: 50px;
            width: 100px; height: 40px; opacity: 0.8; z-index: 0;
            animation: floatClouds 20s linear infinite;
        }
        @keyframes floatClouds {
            from { left: -150px; } to { left: 100%; }
        }

        /* ZEMÄ°N */
        .ground-pattern {
            position: absolute; bottom: 75px; width: 200%; height: 35px;
            background: repeating-linear-gradient(45deg, #8bc34a, #8bc34a 15px, #9ccc65 15px, #9ccc65 30px);
            border-top: 4px solid #558b2f; z-index: 10;
            animation: moveGround 2s linear infinite;
        }
        @keyframes moveGround { from { transform: translateX(0); } to { transform: translateX(-50px); } }

        /* CW KARAKTERÄ° */
        .cw-player {
            width: 50px; height: 35px; background: var(--cw-brown);
            border: 3px solid #000; border-radius: 8px;
            position: relative; box-shadow: inset -4px -4px 0 rgba(0,0,0,0.2);
            display: flex; align-items: center; justify-content: center;
            color: white; font-weight: 900; font-size: 12px; z-index: 20;
        }

        /* MODAL */
        .custom-modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.8);
            display: none; justify-content: center; align-items: center; z-index: 1000;
            backdrop-filter: blur(5px);
        }

        /* SAYFA YÃ–NETÄ°MÄ° */
        .app-page { display: none; height: calc(100vh - 75px); position: relative; }
        .app-page.active { display: block; }

        #game-canvas { display: none; position: absolute; inset: 0; z-index: 50; }
    </style>
</head>
<body>

<div id="mainModal" class="custom-modal">
    <div class="bg-white w-[85%] max-w-sm rounded-[32px] p-8 text-center animate__animated animate__backInUp">
        <div id="modalContent"></div>
        <button onclick="hideModal()" class="w-full bg-blue-600 text-white py-4 rounded-2xl font-bold mt-4 shadow-lg active:scale-95 transition">Tamam</button>
    </div>
</div>

<div class="max-w-md mx-auto h-screen flex flex-col relative overflow-hidden shadow-2xl">
    
    <canvas id="game-canvas"></canvas>

    <div class="p-3 flex items-center justify-between z-50 bg-[#4eb5d3]/50 backdrop-blur-sm">
        <div class="flex items-center gap-2">
            <div class="w-10 h-8 bg-[#9c5c3c] rounded-lg border-2 border-black flex items-center justify-center text-[10px] text-white font-black">CW</div>
            <span class="text-white font-black text-xl italic tracking-tighter">Flappy</span>
        </div>
        <div class="flex items-center gap-1.5">
            <div class="bg-white/20 px-2 py-1 rounded-full text-[10px] text-white font-bold border border-white/30">âœ¿EARNâœ¿...</div>
            <div class="bg-blue-500 text-white text-[10px] font-black px-2.5 py-1 rounded-lg">EN</div>
        </div>
    </div>

    <div id="home-page" class="app-page active">
        <div class="px-3 grid grid-cols-2 gap-2 mt-2">
            <div class="bg-white rounded-2xl p-3 shadow-sm">
                <div class="text-[10px] font-bold text-gray-400 uppercase flex items-center gap-1">
                    <span class="text-red-500">â¤ï¸</span> Attempts <span id="hearts-display" class="text-blue-600 ml-auto">14</span>
                </div>
                <button onclick="showModal('Deneme ArtÄ±r', 'Daha fazla hak iÃ§in gÃ¶revleri tamamla!')" class="w-full bg-blue-500 text-white text-xs py-2 rounded-xl mt-2 font-bold shadow-[0_4px_0_#1d4ed8]">Increase</button>
            </div>
            <div class="bg-white rounded-2xl p-3 shadow-sm text-[10px] font-bold space-y-1">
                <div class="flex justify-between"><span>ğŸ† Daily</span> <span id="daily-score" class="text-blue-500">7.98</span></div>
                <div class="flex justify-between"><span>ğŸ† Record</span> <span id="all-score" class="text-blue-600">7.98</span></div>
                <div class="flex justify-between"><span>ğŸš€ Mult.</span> <span class="text-green-500 font-black">x1.14</span></div>
            </div>
        </div>

        <div class="px-3 mt-4 flex flex-col gap-2">
            <div class="flex gap-2">
                <div class="bg-yellow-400 flex-1 h-14 rounded-xl flex items-center justify-center font-black text-white text-xs shadow-md border-b-4 border-yellow-600">CW PASS</div>
                <div class="flex-[2] bg-blue-500/90 border-2 border-dashed border-white/40 p-2 rounded-xl text-white text-[10px] font-bold flex items-center justify-between">
                    ğŸ Free lottery <span class="bg-white/20 p-1 rounded-full text-xs">ğŸ”Š</span>
                </div>
            </div>
        </div>

        <div class="flex-grow flex flex-col items-center justify-center relative">
            <div class="cw-player animate-bounce">CW</div>
            <button id="startGame" class="mt-16 bg-white p-7 rounded-[35px] shadow-2xl border-4 border-gray-200 active:scale-90 transition-transform">
                <div class="w-0 h-0 border-t-[18px] border-t-transparent border-l-[30px] border-l-green-600 border-b-[18px] border-b-transparent ml-2"></div>
            </button>
        </div>
    </div>

    <div id="wallet-page" class="app-page p-6">
        <div class="bg-white rounded-[40px] p-8 shadow-2xl text-center">
            <div class="text-5xl mb-4">ğŸ’³</div>
            <h1 id="ton-status" class="text-lg font-bold text-gray-400 mb-2 uppercase">CÃ¼zdan BaÄŸlÄ± DeÄŸil</h1>
            <h2 id="balance-display" class="text-4xl font-black text-gray-800 mb-8">0.00 CW</h2>
            
            <div id="ton-ui">
                <button onclick="initTonConnect()" class="w-full bg-[#0088cc] text-white py-4 rounded-2xl font-bold shadow-xl active:scale-95 transition">TON ADRESÄ° BAÄLA</button>
            </div>
        </div>
    </div>

    <div class="cloud" style="top: 20%; animation-delay: 0s;"></div>
    <div class="cloud" style="top: 35%; animation-delay: -5s;"></div>
    <div class="city-silhouette"></div>
    <div class="ground-pattern"></div>

    <div class="h-[75px] bg-white border-t flex justify-around items-center z-[100]">
        <button onclick="changeTab('home', this)" class="tab-btn flex flex-col items-center text-blue-500"><span class="text-2xl">ğŸ®</span><span class="text-[9px] font-bold">Flappy</span></button>
        <button onclick="changeTab('rating', this)" class="tab-btn flex flex-col items-center text-gray-400"><span class="text-2xl">ğŸ†</span><span class="text-[9px] font-bold">Rating</span></button>
        <button onclick="changeTab('home', this)" class="tab-btn flex flex-col items-center text-gray-400"><span class="text-2xl">ğŸ‘¥</span><span class="text-[9px] font-bold">Friends</span></button>
        <button onclick="changeTab('wallet', this)" class="tab-btn flex flex-col items-center text-gray-400"><span class="text-2xl">ğŸ’³</span><span class="text-[9px] font-bold">Wallet</span></button>
        <button onclick="changeTab('home', this)" class="tab-btn flex flex-col items-center text-gray-400"><span class="text-2xl">âœ…</span><span class="text-[9px] font-bold">Tasks</span></button>
    </div>
</div>

<script>
    /* OYUN DEÄÄ°ÅKENLERÄ° */
    let hearts = 14;
    let score = 0;
    let highscore = 7.98;
    let gameActive = false;
    let tonAddress = localStorage.getItem('cw_ton_addr');

    /* MODAL SÄ°STEMÄ° */
    function showModal(title, msg) {
        document.getElementById('modalContent').innerHTML = `<h2 class="text-2xl font-black mb-2">${title}</h2><p class="text-gray-500 font-medium">${msg}</p>`;
        document.getElementById('mainModal').style.display = 'flex';
    }
    function hideModal() { document.getElementById('mainModal').style.display = 'none'; }

    /* TON CÃœZDAN SÄ°STEMÄ° */
    function initTonConnect() {
        const addr = prompt("TON Wallet adresinizi giriniz (UQ...):");
        if(addr && addr.length > 30) {
            localStorage.setItem('cw_ton_addr', addr);
            location.reload();
        } else { alert("GeÃ§ersiz adres!"); }
    }
    if(tonAddress) {
        document.getElementById('ton-status').innerText = "CÃ¼zdan BaÄŸlÄ±";
        document.getElementById('ton-ui').innerHTML = `<p class="text-[10px] font-mono break-all bg-gray-100 p-2 rounded-lg">${tonAddress}</p>`;
    }

    /* SEKME YÃ–NETÄ°MÄ° */
    function changeTab(page, btn) {
        document.querySelectorAll('.app-page').forEach(p => p.classList.remove('active'));
        document.getElementById(page + '-page').classList.add('active');
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.add('text-gray-400'));
        btn.classList.remove('text-gray-400');
        btn.classList.add('text-blue-500');
    }

    /* OYUN MOTORU */
    const canvas = document.getElementById('game-canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth > 450 ? 450 : window.innerWidth;
    canvas.height = window.innerHeight - 75;

    const bird = { x: 50, y: 300, w: 34, h: 24, v: 0, g: 0.25, j: 5 };
    let pipes = [];

    function draw() {
        if(!gameActive) return;
        ctx.fillStyle = "#70c5ce"; ctx.fillRect(0,0, canvas.width, canvas.height);
        
        // Bird
        bird.v += bird.g; bird.y += bird.v;
        ctx.fillStyle = "#9c5c3c"; ctx.fillRect(bird.x, bird.y, bird.w, bird.h);
        ctx.strokeRect(bird.x, bird.y, bird.w, bird.h);

        // Pipes
        if(pipes.length === 0 || pipes[pipes.length-1].x < canvas.width - 200) {
            pipes.push({ x: canvas.width, y: Math.random() * (canvas.height - 250) + 50, gap: 140 });
        }
        pipes.forEach(p => {
            p.x -= 3;
            ctx.fillStyle = "#2ecc71";
            ctx.fillRect(p.x, 0, 50, p.y);
            ctx.fillRect(p.x, p.y + p.gap, 50, canvas.height);
            if(bird.x + bird.w > p.x && bird.x < p.x + 50 && (bird.y < p.y || bird.y + bird.h > p.y + p.gap)) {
                gameActive = false; hearts--;
                document.getElementById('hearts-display').innerText = hearts;
                showModal("OYUN BÄ°TTÄ°", `Skorun: ${score}`);
                canvas.style.display = 'none';
            }
            if(p.x === 50) score++;
        });
        pipes = pipes.filter(p => p.x > -50);
        requestAnimationFrame(draw);
    }

    document.getElementById('startGame').addEventListener('click', () => {
        if(hearts <= 0) return alert("Kalbin bitti!");
        gameActive = true; score = 0; pipes = []; bird.y = 300; bird.v = 0;
        canvas.style.display = 'block'; draw();
    });

    window.addEventListener('touchstart', (e) => { e.preventDefault(); bird.v = -bird.j; });
</script>
</body>
</html>

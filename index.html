<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Spyder Network | Sovereign Enterprise V20</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Plus+Jakarta+Sans:wght@300;400;600;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* --- SUPREME DESIGN SYSTEM V20 (QUANTUM DARK) --- */
        :root {
            --p-purple: #a855f7; --p-glow: rgba(168, 85, 247, 0.6);
            --bg-base: #000000; --bg-card: #08080a;
            --border: rgba(255, 255, 255, 0.04); --text-main: #ffffff;
            --text-dim: #475569; --success: #10b981; --error: #ff4757;
            --warning: #ffa502; --accent: #3742fa; --surface: #0f172a;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg-base); color: var(--text-main); height: 100vh; overflow: hidden; display: flex; flex-direction: column; }

        /* --- LAYOUT ARCHITECTURE --- */
        #viewport { flex: 1; overflow-y: auto; padding: 20px 20px 140px 20px; scroll-behavior: smooth; }
        .view { display: none; flex-direction: column; animation: slideIn 0.5s cubic-bezier(0.19, 1, 0.22, 1); }
        .view.active { display: flex; }
        @keyframes slideIn { from { opacity: 0; transform: scale(0.95) translateY(20px); } to { opacity: 1; transform: scale(1) translateY(0); } }

        /* --- UI COMPONENTS --- */
        .glass-module { background: var(--bg-card); border: 1px solid var(--border); border-radius: 35px; padding: 25px; margin-bottom: 20px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); position: relative; }
        .stat-card { background: var(--surface); border: 1px solid var(--border); padding: 18px; border-radius: 24px; text-align: center; }
        .stat-card b { display: block; font-size: 20px; font-family: 'Orbitron'; margin-top: 5px; }

        /* --- POWER CORE (CLICKER) --- */
        .power-engine { display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 30px 0; }
        .main-trigger {
            width: 250px; height: 250px; background: radial-gradient(circle, #c084fc 0%, #7e22ce 100%);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 110px; cursor: pointer; transition: 0.1s;
            box-shadow: 0 0 100px var(--p-glow), inset 0 0 30px rgba(255,255,255,0.2);
            border: 10px solid rgba(255,255,255,0.02);
        }
        .main-trigger:active { transform: scale(0.9); }

        /* --- MISSION & TASK DESIGN --- */
        .task-box { background: #0f172a; border: 1px solid var(--border); border-radius: 20px; padding: 20px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; }
        .task-val { color: var(--p-purple); font-weight: 800; font-size: 13px; }

        /* --- ADMIN INTELLIGENCE MODAL --- */
        .intel-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 100000; display: none; align-items: center; justify-content: center; padding: 20px; backdrop-filter: blur(10px); }
        .intel-window { background: #050505; border: 2px solid var(--p-purple); width: 100%; max-width: 480px; border-radius: 45px; padding: 35px; max-height: 90vh; overflow-y: auto; box-shadow: 0 0 150px rgba(168, 85, 247, 0.3); }
        .intel-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 20px 0; }
        .intel-item { background: #111; padding: 12px; border-radius: 15px; border: 1px solid #222; }
        .intel-item label { font-size: 9px; color: var(--text-dim); text-transform: uppercase; }

        /* --- NAVIGATION --- */
        nav { position: fixed; bottom: 0; width: 100%; height: 100px; background: rgba(0,0,0,0.9); border-top: 1px solid var(--border); display: flex; justify-content: space-around; align-items: center; padding-bottom: 15px; z-index: 9999; }
        .nav-link { color: var(--text-dim); display: flex; flex-direction: column; align-items: center; gap: 5px; cursor: pointer; transition: 0.3s; }
        .nav-link.active { color: var(--p-purple); }
        .nav-link i { font-size: 24px; font-style: normal; }
        .nav-link span { font-size: 9px; font-weight: 800; letter-spacing: 1px; }

        .btn-action { width: 100%; padding: 16px; border-radius: 20px; border: none; background: var(--p-purple); color: #fff; font-weight: 900; cursor: pointer; transition: 0.2s; }
        .btn-action:active { transform: scale(0.95); }
    </style>
</head>
<body>

    <div id="intel-modal" class="intel-overlay">
        <div class="intel-window">
            <h2 id="int-name" class="orbitron" style="text-align:center; color:var(--p-purple);">USER_DOSSIER</h2>
            <div class="intel-grid">
                <div class="intel-item"><label>Spyder</label><b id="int-bal">0</b></div>
                <div class="intel-item"><label>USDT</label><b id="int-usdt" style="color:var(--success)">$0</b></div>
                <div class="intel-item"><label>Referans</label><b id="int-ref">0</b></div>
                <div class="intel-item"><label>Reklam</label><b id="int-ads">0</b></div>
                <div class="intel-item" style="grid-column: span 2;"><label>Son G√∂r√ºlme</label><b id="int-last">-</b></div>
                <div class="intel-item" style="grid-column: span 2;"><label>C√ºzdan</label><b id="int-wallet" style="font-size:10px;">Baƒülƒ± Deƒüil</b></div>
            </div>
            
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                <button onclick="Admin.action('ban')" id="int-ban-btn" class="btn-action" style="background:var(--error)">BANLA</button>
                <button onclick="Admin.action('archive')" id="int-arc-btn" class="btn-action" style="background:#222">AR≈ûƒ∞VLE</button>
                <button onclick="Admin.adj('bal', 50000)" class="btn-action" style="background:var(--success); grid-column: span 2;">+50K SPYDER EKLE</button>
                <button onclick="Admin.close()" class="btn-action" style="background:#000; border:1px solid #333; grid-column: span 2;">KAPAT</button>
            </div>
        </div>
    </div>

    <main id="viewport">
        <section id="v-mine" class="view active">
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:12px;">
                <div class="stat-card"><small class="dim">SPYDER</small><b id="u-bal">0</b></div>
                <div class="stat-card"><small class="dim">USDT</small><b id="u-usdt" style="color:var(--success)">$0.00</b></div>
            </div>
            <div class="power-engine">
                <div class="main-trigger" onclick="Core.tap(event)">üï∑Ô∏è</div>
            </div>
            <div class="glass-module">
                <div style="display:flex; justify-content:space-between; font-size:10px; font-weight:900; margin-bottom:10px;">
                    <span class="orbitron">CORE_ENERGY</span>
                    <span id="u-nrg-txt">1000/1000</span>
                </div>
                <div style="height:12px; background:#000; border-radius:10px; overflow:hidden;">
                    <div id="u-nrg-bar" style="width:100%; height:100%; background:var(--p-purple); box-shadow: 0 0 20px var(--p-purple);"></div>
                </div>
            </div>
        </section>

        <section id="v-task" class="view">
            <h2 class="orbitron" style="margin-bottom:20px;">MISSIONS_HUB</h2>
            <div id="task-list">
                <div class="task-box">
                    <div><b>Kanal Takibi</b><br><span class="task-val">+100,000 SPYDER</span></div>
                    <button class="btn-action" style="width:auto; padding:8px 20px;" onclick="Core.doTask('tg_1', 100000)">YAP</button>
                </div>
                <div class="task-box">
                    <div><b>X (Twitter) Takip</b><br><span class="task-val">+50,000 SPYDER</span></div>
                    <button class="btn-action" style="width:auto; padding:8px 20px;" onclick="Core.doTask('x_1', 50000)">YAP</button>
                </div>
            </div>
        </section>

        <section id="v-ref" class="view">
            <h2 class="orbitron">NETWORK_GRID</h2>
            <div class="glass-module" style="text-align:center;">
                <p class="dim" style="font-size:13px;">Her davet i√ßin 25,000 Spyder kazanƒ±n.</p>
                <div style="background:#000; padding:15px; border-radius:15px; margin:15px 0; color:var(--p-purple); font-family:'JetBrains Mono'; word-break:break-all;" id="ref-link">Y√ºkleniyor...</div>
                <button class="btn-action" onclick="Core.copyRef()">DAVET Lƒ∞NKƒ∞Nƒ∞ KOPYALA</button>
            </div>
        </section>

        <section id="v-admin" class="view">
            <h2 class="orbitron" style="color:var(--warning); margin-bottom:20px;">CENTRAL_INTELLIGENCE</h2>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-bottom:20px;">
                <div class="stat-card" style="background:var(--bg-card)"><small>TOPLAM √úYE</small><b id="adm-u">0</b></div>
                <div class="stat-card" style="background:var(--bg-card)"><small>TOPLAM REKLAM</small><b id="adm-a" style="color:var(--warning)">0</b></div>
            </div>
            
            <div style="display:flex; gap:10px; margin-bottom:15px;">
                <button class="btn-action" style="background:#111; font-size:11px;" onclick="Admin.setTab('active')">AKTƒ∞F</button>
                <button class="btn-action" style="background:#111; font-size:11px;" onclick="Admin.setTab('archive')">AR≈ûƒ∞V</button>
                <button class="btn-action" style="background:#111; font-size:11px;" onclick="Admin.setTab('banned')">BANLI</button>
            </div>

            <div id="adm-list"></div>
        </section>
    </main>

    <nav>
        <div class="nav-link active" onclick="Nav.go('v-mine', this)"><i>üéÆ</i><span>OYNA</span></div>
        <div class="nav-link" onclick="Nav.go('v-task', this)"><i>üì°</i><span>G√ñREV</span></div>
        <div class="nav-link" onclick="Nav.go('v-ref', this)"><i>üë•</i><span>NETWORK</span></div>
        <div id="adm-btn" class="nav-link" style="display:none;" onclick="Nav.go('v-admin', this); Admin.boot();"><i>üîë</i><span>OS_CORE</span></div>
    </nav>

    <script>
        /* --- SYSTEM INITIALIZATION --- */
        const ADMIN_ID = "8392479231";
        const FIRE_CONF = {
            apiKey: "AIzaSyC18uinYQT9vOC-nhxv3x1WIhO_we3CRMY",
            authDomain: "pdfkaynak-51615.firebaseapp.com",
            projectId: "pdfkaynak-51615",
            appId: "1:228512804576:web:a0bba02ca83b4fa7adea85"
        };
        firebase.initializeApp(FIRE_CONF);
        const db = firebase.firestore();
        const tg = window.Telegram.WebApp;

        let user = { bal:0, usdt:0, nrg:1000, ads:0, totalAds:0, refCount:0, tasks:[], isBanned:false, isArchived:false };
        let uid = tg.initDataUnsafe?.user?.id?.toString() || "dev_root";
        let admTab = 'active';

        const Core = {
            init: async () => {
                const doc = await db.collection("users").doc(uid).get();
                if(doc.exists) user = { ...user, ...doc.data() };
                else await Core.save();
                
                if(uid === ADMIN_ID) document.getElementById('adm-btn').style.display='flex';
                document.getElementById('ref-link').innerText = `https://t.me/SpyderBot?start=${uid}`;
                
                Core.loops();
                UI.refresh();
            },
            tap: (e) => {
                if(user.nrg < 2 || user.isBanned) return;
                user.bal += 1; user.nrg -= 2;
                UI.refresh();
                if(user.bal % 50 === 0) Core.save();
            },
            save: async () => {
                await db.collection("users").doc(uid).set({
                    ...user, name: tg.initDataUnsafe?.user?.first_name || "Agent",
                    lastActive: Date.now()
                }, {merge:true});
            },
            loops: () => {
                setInterval(() => {
                    if(user.nrg < 1000) { user.nrg = Math.min(1000, user.nrg + 15); UI.refresh(); }
                }, 3000);
            },
            doTask: async (tid, rew) => {
                if(user.tasks.includes(tid)) return tg.showAlert("Zaten yapƒ±ldƒ±.");
                window.open("https://t.me/SpyderNetwork");
                setTimeout(async () => {
                    user.bal += rew; user.tasks.push(tid);
                    await Core.save(); UI.refresh();
                    tg.showAlert("√ñd√ºl tanƒ±mlandƒ±!");
                }, 2000);
            },
            copyRef: () => {
                const link = document.getElementById('ref-link').innerText;
                const el = document.createElement('textarea'); el.value = link;
                document.body.appendChild(el); el.select(); document.execCommand('copy');
                document.body.removeChild(el); tg.showAlert("Kopyalandƒ±!");
            }
        };

        const Admin = {
            users: [],
            boot: async () => {
                const snap = await db.collection("users").get();
                Admin.users = []; let tAds = 0;
                snap.forEach(d => {
                    Admin.users.push({id: d.id, ...d.data()});
                    tAds += (d.data().totalAds || 0);
                });
                document.getElementById('adm-u').innerText = snap.size;
                document.getElementById('adm-a').innerText = tAds;
                Admin.render();
            },
            setTab: (t) => { admTab = t; Admin.render(); },
            render: () => {
                const list = document.getElementById('adm-list'); list.innerHTML = "";
                let f = Admin.users.filter(u => {
                    if(admTab === 'active') return !u.isBanned && !u.isArchived;
                    if(admTab === 'archive') return u.isArchived;
                    if(admTab === 'banned') return u.isBanned;
                });
                f.forEach(u => {
                    list.innerHTML += `<div class="task-box" onclick="Admin.openIntel('${u.id}')">
                        <div><b>${u.name}</b><br><small class="dim">$${(u.usdt||0).toFixed(2)}</small></div>
                        <div class="orbitron" style="color:var(--p-purple)">${u.bal.toLocaleString()}</div>
                    </div>`;
                });
            },
            openIntel: (id) => {
                const u = Admin.users.find(x => x.id === id);
                Admin.sel = u;
                document.getElementById('int-name').innerText = u.name.toUpperCase();
                document.getElementById('int-bal').innerText = u.bal.toLocaleString();
                document.getElementById('int-usdt').innerText = "$" + (u.usdt||0).toFixed(2);
                document.getElementById('int-ref').innerText = u.refCount || 0;
                document.getElementById('int-ads').innerText = u.totalAds || 0;
                document.getElementById('int-last').innerText = new Date(u.lastActive).toLocaleString();
                document.getElementById('int-ban-btn').innerText = u.isBanned ? "BAN KALDIR" : "BANLA";
                document.getElementById('int-arc-btn').innerText = u.isArchived ? "AR≈ûƒ∞VDEN √áIKAR" : "AR≈ûƒ∞VLE";
                document.getElementById('intel-modal').style.display = 'flex';
            },
            action: async (type) => {
                let upd = {};
                if(type === 'ban') upd = { isBanned: !Admin.sel.isBanned };
                if(type === 'archive') upd = { isArchived: !Admin.sel.isArchived };
                await db.collection("users").doc(Admin.sel.id).update(upd);
                Admin.close(); Admin.boot();
            },
            adj: async (t, v) => {
                await db.collection("users").doc(Admin.sel.id).update({
                    bal: firebase.firestore.FieldValue.increment(v)
                });
                Admin.close(); Admin.boot();
            },
            close: () => document.getElementById('intel-modal').style.display='none'
        };

        const Nav = {
            go: (id, el) => {
                document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
                document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active'));
                document.getElementById(id).classList.add('active');
                el.classList.add('active');
            }
        };

        const UI = {
            refresh: () => {
                document.getElementById('u-bal').innerText = user.bal.toLocaleString();
                document.getElementById('u-usdt').innerText = "$" + user.usdt.toFixed(2);
                document.getElementById('u-nrg-txt').innerText = `${user.nrg}/1000`;
                document.getElementById('u-nrg-bar').style.width = (user.nrg / 10) + "%";
            }
        };

        Core.init();
    </script>
</body>
</html>

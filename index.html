<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>SpyderCoin - Ad-Reward Edition</title>
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://adexora.com/cdn/ads.js?id=1545"></script>

    <style>
        :root {
            --spyder-purple: #a855f7;
            --spyder-purple-deep: #7c3aed;
            --spyder-purple-glow: rgba(168, 85, 247, 0.45);
            --spyder-bg-black: #070708;
            --spyder-card-bg: #111113;
            --spyder-card-border: #1f1f22;
            --spyder-text-white: #ffffff;
            --spyder-text-dim: #94a3b8;
            --spyder-green: #10b981;
            --radius-xl: 28px;
            --radius-md: 16px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; user-select: none; cursor: default; }
        body { background-color: var(--spyder-bg-black); color: var(--spyder-text-white); font-family: 'Inter', sans-serif; overflow: hidden; width: 100vw; height: 100vh; display: flex; flex-direction: column; }

        .app-container { flex: 1; width: 100%; position: relative; overflow-y: auto; padding-bottom: 120px; }
        .page { display: none; flex-direction: column; align-items: center; width: 100%; padding: 25px; animation: slideIn 0.4s ease; }
        .page.active { display: flex; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        /* üï∑Ô∏è ANA SAYFA & TAPPER */
        .balance-amount { font-size: 64px; font-weight: 950; background: linear-gradient(180deg, #fff, var(--spyder-purple)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-align: center; margin: 10px 0; filter: drop-shadow(0 0 10px var(--spyder-purple-glow)); }
        .spider-target { width: 240px; height: 240px; background: radial-gradient(circle, #c084fc, var(--spyder-purple-deep)); border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 100px; box-shadow: 0 0 40px var(--spyder-purple-glow); transition: transform 0.05s; margin: 20px 0; cursor: pointer; }
        .spider-target:active { transform: scale(0.92); }

        /* üì∫ REKLAM BUTONU */
        .ad-earn-btn { background: linear-gradient(90deg, #fbbf24, #d97706); color: #000; border: none; padding: 12px 24px; border-radius: 12px; font-weight: 900; font-size: 14px; margin-bottom: 20px; cursor: pointer; box-shadow: 0 4px 15px rgba(251, 191, 36, 0.3); display: flex; align-items: center; gap: 8px; transition: 0.3s; }
        .ad-earn-btn:hover { transform: translateY(-2px); filter: brightness(1.1); }

        /* üîã ENERJƒ∞ */
        .footer-metrics { width: 100%; max-width: 400px; padding: 20px; background: rgba(255,255,255,0.02); border-radius: var(--radius-xl); border: 1px solid var(--spyder-card-border); }
        .energy-bar { width: 100%; height: 14px; background: #151518; border-radius: 40px; overflow: hidden; border: 1px solid #252529; margin-top: 8px; }
        .energy-fill { height: 100%; background: var(--spyder-purple); transition: width 0.15s; }

        /* üèõÔ∏è VAULT & WALLET */
        .finance-card { background: var(--spyder-card-bg); border: 1px solid var(--spyder-card-border); border-radius: var(--radius-xl); padding: 25px; width: 100%; margin-bottom: 15px; }
        .status-pill { padding: 6px 12px; border-radius: 8px; font-size: 11px; font-weight: 900; text-transform: uppercase; }
        .pill-locked { background: #27272a; color: #71717a; }
        .pill-ready { background: var(--spyder-green); color: #fff; }

        .btn-spyder { width: 100%; padding: 18px; border-radius: 14px; border: none; font-size: 16px; font-weight: 900; cursor: pointer; background: var(--spyder-purple); color: #fff; text-transform: uppercase; }
        .btn-spyder:disabled { background: #27272a; color: #52525b; cursor: not-allowed; }

        /* NAV */
        .navbar { position: fixed; bottom: 0; width: 100%; height: 90px; background: #0a0a0b; display: grid; grid-template-columns: repeat(5, 1fr); border-top: 1px solid #1c1c1e; padding-bottom: 20px; }
        .nav-item { display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--spyder-text-dim); font-size: 10px; font-weight: 700; cursor: pointer; }
        .nav-item.active { color: var(--spyder-purple); }
        .nav-item i { font-style: normal; font-size: 22px; margin-bottom: 4px; }

        .tap-anim { position: absolute; color: white; font-size: 32px; font-weight: 900; pointer-events: none; animation: float 0.8s ease-out forwards; z-index: 100; }
        @keyframes float { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-120px); } }
    </style>
</head>
<body>

    <main class="app-container">
        <section id="p-home" class="page active">
            <button class="ad-earn-btn" onclick="AdController.watchRewarded()">
                <span>üì∫</span> REKLAM ƒ∞ZLE (+15 SPYDER)
            </button>
            <div style="text-align:center;">
                <p style="color:var(--spyder-text-dim); font-size:12px; letter-spacing:2px;">SPYDER BALANCE</p>
                <h1 class="balance-amount" id="ui-bal">0</h1>
            </div>
            <div class="spider-target" id="spider-btn">üï∑Ô∏è</div>
            <div class="footer-metrics">
                <div style="display:flex; justify-content:space-between; font-size:14px; font-weight:800;">
                    <span>‚ö° ENERGY</span>
                    <span><span id="ui-nrg">1000</span>/1000</span>
                </div>
                <div class="energy-bar"><div id="ui-nrg-bar" class="energy-fill"></div></div>
            </div>
        </section>

        <section id="p-vault" class="page">
            <h2 style="align-self:flex-start; margin-bottom:20px;">Vault Swap</h2>
            <div class="finance-card">
                <p style="font-size:11px; color:var(--spyder-text-dim);">TAKAS Mƒ∞KTARI (SPYDER)</p>
                <input type="number" id="swap-in" value="1000" oninput="updateSwap()" style="width:100%; background:#000; border:1px solid #333; color:white; padding:15px; border-radius:12px; font-size:24px; font-weight:bold; margin:10px 0; text-align:center;">
                <p style="text-align:center; font-size:20px;">‚¨áÔ∏è</p>
                <div style="background:#000; padding:15px; border-radius:12px; text-align:center;">
                    <span id="swap-out" style="font-size:24px; font-weight:bold; color:var(--spyder-green);">0.010</span>
                    <span style="font-size:12px; color:var(--spyder-green);"> USDT</span>
                </div>
                <button class="btn-spyder" style="margin-top:20px;" onclick="executeSwap()">TAKAS ET</button>
            </div>
        </section>

        <section id="p-wallet" class="page">
            <h2 style="align-self:flex-start; margin-bottom:20px;">C√ºzdan & √ñdeme</h2>
            <div class="finance-card" style="text-align:center;">
                <p style="color:var(--spyder-text-dim); font-size:12px;">√áEKƒ∞LEBƒ∞Lƒ∞R BAKƒ∞YE</p>
                <h1 style="font-size:48px; color:var(--spyder-green);">$<span id="ui-usdt">0.00</span></h1>
            </div>
            <div class="finance-card">
                <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                    <span id="label-ads">Reklam ≈ûartƒ±</span>
                    <span id="status-ads" class="status-pill pill-locked">0 / 20</span>
                </div>
                <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                    <span>Min. √ñdeme ($0.01)</span>
                    <span id="status-min" class="status-pill pill-locked">BEKLE</span>
                </div>
                <input type="text" id="wallet-addr" placeholder="BEP20 C√ºzdan Adresi" style="width:100%; background:#000; border:1px solid #333; color:white; padding:15px; border-radius:12px; text-align:center;">
                <button id="btn-withdraw" class="btn-spyder" style="margin-top:20px;" disabled onclick="requestWithdraw()">√ñDEME AL</button>
            </div>
        </section>
    </main>

    <nav class="navbar">
        <div class="nav-item active" onclick="nav('p-home', this)"><i>üéÆ</i>Oyna</div>
        <div class="nav-item" onclick="nav('p-vault', this)"><i>üèõÔ∏è</i>Vault</div>
        <div class="nav-item" onclick="nav('p-wallet', this)"><i>üí∞</i>C√ºzdan</div>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        let state = { bal: 0, nrg: 1000, ads: 0, usdt: 0, tapCount: 0 };

        const AdController = {
            //  √∂d√ºll√º Reklam (Buton ile)
            watchRewarded: () => {
                window.showAdexora()
                    .then(() => {
                        state.bal += 15;
                        state.ads += 1;
                        updateUI();
                        tg.showAlert("Tebrikler! +15 Spyder kazandƒ±nƒ±z ve reklam sayacƒ±nƒ±z arttƒ±.");
                    })
                    .catch(e => {
                        tg.showAlert("Reklam ≈üu an hazƒ±r deƒüil, l√ºtfen sonra tekrar deneyin.");
                        console.error("AdError:", e);
                    });
            },
            // Ge√ßi≈ü Reklamƒ± (Her 10 tƒ±klamada)
            showInterstitial: () => {
                window.showAdexora()
                    .then(() => {
                        state.ads += 1;
                        updateUI();
                    })
                    .catch(e => console.log("Ad skip or error"));
            }
        };

        function handleInteraction(e) {
            if (state.nrg <= 0) return;

            state.bal += 1;
            state.nrg -= 1;
            state.tapCount += 1;

            // HER 10 TIKLAMADA 1 REKLAM
            if (state.tapCount >= 10) {
                state.tapCount = 0;
                AdController.showInterstitial();
            }

            const x = e.touches ? e.touches[0].clientX : e.clientX;
            const y = e.touches ? e.touches[0].clientY : e.clientY;
            createParticle(x, y);
            updateUI();
            tg.HapticFeedback.impactOccurred('light');
        }

        function createParticle(x, y) {
            const p = document.createElement('div');
            p.className = 'tap-anim';
            p.innerText = '+1';
            p.style.left = x + 'px'; p.style.top = y + 'px';
            document.body.appendChild(p);
            setTimeout(() => p.remove(), 800);
        }

        function updateUI() {
            document.getElementById('ui-bal').innerText = state.bal.toLocaleString();
            document.getElementById('ui-nrg').innerText = state.nrg;
            document.getElementById('ui-usdt').innerText = state.usdt.toFixed(4);
            document.getElementById('ui-nrg-bar').style.width = (state.nrg / 10) + "%";

            let reqAds = Math.max(20, Math.ceil((state.usdt / 0.01) * 20));
            if(state.usdt === 0) reqAds = 20;

            document.getElementById('label-ads').innerText = `Reklam ≈ûartƒ± (Hedef: ${reqAds})`;
            const sAds = document.getElementById('status-ads');
            sAds.innerText = `${state.ads} / ${reqAds}`;
            sAds.className = state.ads >= reqAds ? "status-pill pill-ready" : "status-pill pill-locked";

            const sMin = document.getElementById('status-min');
            if(state.usdt >= 0.01) { sMin.innerText = "TAMAM"; sMin.className = "status-pill pill-ready"; }
            else { sMin.innerText = "BEKLE"; sMin.className = "status-pill pill-locked"; }

            document.getElementById('btn-withdraw').disabled = !(state.usdt >= 0.01 && state.ads >= reqAds);
            updateSwap();
        }

        function updateSwap() {
            const val = document.getElementById('swap-in').value;
            document.getElementById('swap-out').innerText = (val * 0.00001).toFixed(4);
        }

        function executeSwap() {
            const val = parseInt(document.getElementById('swap-in').value);
            if(state.bal < val) return tg.showAlert("Yetersiz bakiye!");
            state.bal -= val;
            state.usdt += (val * 0.00001);
            updateUI();
            tg.showAlert("Takas ba≈üarƒ±lƒ±! USDT bakiyeniz g√ºncellendi.");
        }

        function nav(id, el) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            el.classList.add('active');
        }

        const btn = document.getElementById('spider-btn');
        btn.addEventListener('touchstart', (e) => { e.preventDefault(); handleInteraction(e); });
        btn.addEventListener('mousedown', (e) => { if(!('ontouchstart' in window)) handleInteraction(e); });

        setInterval(() => { if(state.nrg < 1000) { state.nrg++; updateUI(); } }, 1500);
        updateUI();
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emoji Cash Pro</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <script src="https://adexora.com/cdn/ads.js?id=1545"></script>

    <style>
        :root { --primary: #6c5ce7; --secondary: #00b894; --bg: #f4f7f6; }
        body { font-family: sans-serif; margin: 0; background: var(--bg); display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        .tab-content { flex: 1; display: none; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        .active-tab { display: flex; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); width: 90%; max-width: 350px; text-align: center; }
        #emoji { font-size: 100px; cursor: pointer; user-select: none; transition: 0.1s; margin: 20px 0; }
        #emoji:active { transform: scale(0.9); }
        .nav-bar { background: white; display: flex; justify-content: space-around; padding: 15px 0; border-top: 1px solid #ddd; }
        .nav-item { cursor: pointer; text-align: center; font-size: 12px; color: #888; }
        .nav-item.active { color: var(--primary); font-weight: bold; }
        input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; border: none; border-radius: 8px; background: var(--primary); color: white; cursor: pointer; font-weight: bold; }
        button:disabled { background: #ccc; }
        .info-box { font-size: 14px; margin-top: 10px; color: #555; }
    </style>
</head>
<body>

    <div id="tab-earn" class="tab-content active-tab">
        <div class="card">
            <small>MEVCUT BAKÄ°YE</small>
            <div style="font-size: 32px; color: var(--secondary); font-weight: bold;">$<span id="earn-balance">0.00000</span></div>
        </div>
        <div id="emoji">ðŸ’°</div>
        <div class="info-box">
            Reklama kalan: <b id="ad-counter">10</b> tÄ±klama<br>
            <small>(Her $0.01 iÃ§in reklam zorluÄŸu +15 artar)</small>
        </div>
    </div>

    <div id="tab-wallet" class="tab-content">
        <h2>Ã–deme Talebi</h2>
        <div class="card">
            <p>Min. Ã‡ekim: <b>$0.50</b></p>
            <input type="number" id="withdraw-amount" placeholder="KaÃ§ USDT alacaksÄ±nÄ±z?">
            <input type="text" id="wallet-address" placeholder="USDT (TRC20) Adresiniz">
            <button id="withdraw-btn" onclick="sendWithdrawal()" disabled>Ã–deme Ä°steÄŸini GÃ¶nder</button>
            <p id="error-msg" style="color:red; font-size:12px; margin-top:10px;"></p>
        </div>
    </div>

    <div class="nav-bar">
        <div class="nav-item active" onclick="showTab('earn', this)"><span>ðŸ’°</span><br>Kazan</div>
        <div class="nav-item" onclick="showTab('wallet', this)"><span>ðŸ’³</span><br>CÃ¼zdan</div>
    </div>

    <script>
        // --- FIREBASE CONFIG ---
        const firebaseConfig = {
            apiKey: "API_KEY",
            authDomain: "PROJE.firebaseapp.com",
            databaseURL: "https://PROJE.firebaseio.com",
            projectId: "PROJE",
            storageBucket: "PROJE.appspot.com",
            appId: "APP_ID"
        };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const userId = "user_test_123"; // BurayÄ± kullanÄ±cÄ±ya Ã¶zel ID yapabilirsin

        let balance = 0;
        let adStep = 0;

        function getRequiredClicks() {
            // Temel 10 tÄ±klama + (her 0.01$ iÃ§in +15 tÄ±klama)
            let difficulty = Math.floor(balance / 0.01) * 15;
            return 10 + difficulty;
        }

        function showTab(tabName, element) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active-tab'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById('tab-' + tabName).classList.add('active-tab');
            element.classList.add('active');
            checkWithdrawalStatus();
        }

        document.getElementById('emoji').addEventListener('click', () => {
            adStep++;
            let required = getRequiredClicks();
            
            if (adStep >= required) {
                adStep = 0;
                showAd();
            } else {
                updateReward();
            }
            document.getElementById('ad-counter').innerText = required - adStep;
        });

        function showAd() {
            if (typeof window.showAdexora === 'function') {
                window.showAdexora().then(() => updateReward()).catch(() => updateReward());
            } else {
                updateReward();
            }
        }

        function updateReward() {
            balance += 0.00001;
            database.ref('users/' + userId).update({ balance: balance });
            renderUI();
        }

        function renderUI() {
            document.getElementById('earn-balance').innerText = balance.toFixed(5);
            document.getElementById('ad-counter').innerText = getRequiredClicks() - adStep;
            checkWithdrawalStatus();
        }

        function checkWithdrawalStatus() {
            const btn = document.getElementById('withdraw-btn');
            const msg = document.getElementById('error-msg');
            if (balance >= 0.50) {
                btn.disabled = false;
                msg.innerText = "";
            } else {
                btn.disabled = true;
                msg.innerText = "Yetersiz bakiye (Min $0.50)";
            }
        }

        function sendWithdrawal() {
            const amount = document.getElementById('withdraw-amount').value;
            const address = document.getElementById('wallet-address').value;

            if (amount > balance) {
                alert("Bakiyenizden fazla Ã§ekemezsiniz!");
                return;
            }
            if (address.length < 10) {
                alert("GeÃ§erli bir USDT adresi giriniz!");
                return;
            }

            // Firebase'e Ã¶deme talebi gÃ¶nder
            database.ref('withdrawals').push({
                userId: userId,
                amount: amount,
                address: address,
                status: "pending",
                date: Date.now()
            }).then(() => {
                alert("Talep alÄ±ndÄ±! Bakiyeniz kontrol edildikten sonra gÃ¶nderilecektir.");
                // Bakiyeyi dÃ¼ÅŸ (Ä°steÄŸe baÄŸlÄ±)
                balance -= amount;
                database.ref('users/' + userId).update({ balance: balance });
                renderUI();
            });
        }

        // Firebase Veri Dinleme
        database.ref('users/' + userId).on('value', (s) => {
            if(s.val()) { balance = s.val().balance || 0; renderUI(); }
        });
    </script>
</body>
</html>

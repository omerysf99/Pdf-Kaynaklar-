<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spyder Network</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <script src="https://adexora.com/cdn/ads.js?id=1545"></script>

    <style>
        :root { --red: #ff0000; --blue: #003366; --dark: #050505; }
        body { font-family: 'Arial', sans-serif; margin: 0; background: var(--dark); color: white; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        /* Sekmeler */
        .tab-content { flex: 1; display: none; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        .active-tab { display: flex; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Kartlar */
        .card { background: rgba(255, 255, 255, 0.05); border: 2px solid var(--red); border-radius: 25px; padding: 25px; width: 85%; max-width: 380px; text-align: center; box-shadow: 0 0 15px rgba(255, 0, 0, 0.3); }
        
        #spidey-btn { font-size: 110px; cursor: pointer; user-select: none; transition: 0.1s; margin: 25px 0; filter: drop-shadow(0 0 10px red); }
        #spidey-btn:active { transform: scale(0.85); }

        .nav-bar { background: #111; display: flex; border-top: 1px solid #333; padding: 12px 0; }
        .nav-item { flex: 1; text-align: center; color: #555; font-size: 13px; cursor: pointer; }
        .nav-item.active { color: var(--red); font-weight: bold; }

        input { width: 100%; padding: 12px; margin: 8px 0; border-radius: 10px; border: 1px solid #333; background: #000; color: white; }
        button { width: 100%; padding: 14px; border: none; border-radius: 10px; background: var(--red); color: white; font-weight: bold; cursor: pointer; margin-top: 10px; }
        button:disabled { background: #333; cursor: not-allowed; }

        .ref-link-box { background: #000; padding: 15px; border-radius: 10px; border: 1px dashed #f00; font-size: 12px; margin-top: 15px; word-break: break-all; color: #0f0; }
    </style>
</head>
<body>

    <div id="tab-earn" class="tab-content active-tab">
        <div class="card">
            <small>GÃœNCEL BAKÄ°YE</small>
            <div style="font-size: 36px; font-weight: bold; color: var(--red);">$<span id="balance">0.00000</span></div>
        </div>
        <div id="spidey-btn">ğŸ•·ï¸</div>
        <p>AÄŸ AtÄ±ÅŸÄ±na: <b id="ad-step">10</b> TÄ±k</p>
    </div>

    <div id="tab-ref" class="tab-content">
        <h2>Referans Sistemi</h2>
        <div class="card">
            <p>ArkadaÅŸlarÄ±nÄ± davet et, her tÄ±klarÄ±ndan <br><b style="color:#0f0;">$0.000005</b> kazan!</p>
            <div class="ref-link-box" id="ref-url">OluÅŸturuluyor...</div>
            <button onclick="copyRef()">LÄ°NKÄ° KOPYALA</button>
            <p style="margin-top:20px;">Toplam Ãœyen: <b id="ref-count">0</b></p>
        </div>
    </div>

    <div id="tab-wallet" class="tab-content">
        <h2>CÃ¼zdan</h2>
        <div class="card">
            <p>Min Ã‡ekim: <b>$0.50</b></p>
            <input type="number" id="w-amount" placeholder="USDT MiktarÄ±">
            <input type="text" id="w-address" placeholder="USDT TRC20 Adresi">
            <button id="w-btn" onclick="requestPay()" disabled>Bakiye Yetersiz</button>
        </div>
    </div>

    <div class="nav-bar">
        <div class="nav-item active" onclick="setTab('earn', this)"><span>ğŸ•¸ï¸</span><br>Kazan</div>
        <div class="nav-item" onclick="setTab('ref', this)"><span>ğŸ‘¥</span><br>Ref</div>
        <div class="nav-item" onclick="setTab('wallet', this)"><span>ğŸ’³</span><br>CÃ¼zdan</div>
    </div>

    <script>
        // --- FIREBASE AYARLARI ---
        const firebaseConfig = {
            apiKey: "API_KEY",
            authDomain: "PROJE.firebaseapp.com",
            databaseURL: "https://PROJE.firebaseio.com",
            projectId: "PROJE",
            appId: "APP_ID"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // KULLANICI KÄ°MLÄ°ÄÄ° (ID)
        let userId = localStorage.getItem('spyder_uid');
        if (!userId) {
            userId = Math.floor(100000 + Math.random() * 900000).toString(); // 6 Haneli ID
            localStorage.setItem('spyder_uid', userId);
        }

        // TELEGRAM TARZI REF KONTROLÃœ (?start=ID)
        const params = new URLSearchParams(window.location.search);
        const startParam = params.get('start');

        // REF LÄ°NKÄ° OLUÅTURMA (Telegram formatÄ±nda gÃ¶rÃ¼nÃ¼m)
        const myLink = "https://t.me/SpyderNetworkBot?start=" + userId;
        document.getElementById('ref-url').innerText = myLink;

        let userBal = 0;
        let clickCount = 0;
        let bossId = "";

        // KAYIT VE REFERANS BAÅLATMA
        db.ref('users/' + userId).once('value', s => {
            if (!s.exists()) {
                db.ref('users/' + userId).set({
                    balance: 0,
                    invitedBy: (startParam && startParam !== userId) ? startParam : "",
                    refs: 0
                });
                if (startParam && startParam !== userId) {
                    db.ref('users/' + startParam + '/refs').transaction(c => (c || 0) + 1);
                }
            }
        });

        // VERÄ° DÄ°NLEME
        db.ref('users/' + userId).on('value', s => {
            if (s.val()) {
                userBal = s.val().balance || 0;
                bossId = s.val().invitedBy || "";
                document.getElementById('balance').innerText = userBal.toFixed(5);
                document.getElementById('ref-count').innerText = s.val().refs || 0;
                
                const btn = document.getElementById('w-btn');
                if(userBal >= 0.50) {
                    btn.disabled = false;
                    btn.innerText = "Ã–deme Talebi GÃ¶nder";
                }
            }
        });

        // TIKLAMA
        document.getElementById('spidey-btn').addEventListener('click', () => {
            clickCount++;
            let req = 10 + (Math.floor(userBal / 0.01) * 15);
            
            if (clickCount >= req) {
                clickCount = 0;
                if (window.showAdexora) window.showAdexora().then(() => reward());
                else reward();
            } else {
                reward();
            }
            document.getElementById('ad-step').innerText = Math.max(0, req - clickCount);
        });

        function reward() {
            // Kendi kazancÄ±n
            db.ref('users/' + userId + '/balance').transaction(b => (b || 0) + 0.00001);
            // Seni davet edenin kazancÄ±
            if (bossId) {
                db.ref('users/' + bossId + '/balance').transaction(b => (b || 0) + 0.000005);
            }
        }

        function setTab(t, el) {
            document.querySelectorAll('.tab-content').forEach(x => x.classList.remove('active-tab'));
            document.querySelectorAll('.nav-item').forEach(x => x.classList.remove('active'));
            document.getElementById('tab-' + t).classList.add('active-tab');
            el.classList.add('active');
        }

        function copyRef() {
            navigator.clipboard.writeText(myLink);
            alert("Referans linkin kopyalandÄ±!");
        }

        function requestPay() {
            const amt = parseFloat(document.getElementById('w-amount').value);
            const adr = document.getElementById('w-address').value;
            if (amt > userBal || amt < 0.50) return alert("GeÃ§ersiz miktar!");
            
            db.ref('withdrawals').push({ uid: userId, amount: amt, address: adr, date: Date.now() });
            db.ref('users/' + userId + '/balance').transaction(b => b - amt);
            alert("Talep alÄ±ndÄ±!");
        }
    </script>
</body>
</html>

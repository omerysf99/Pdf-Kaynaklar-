<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Spyder Network V800</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&family=Plus+Jakarta+Sans:wght@400;800&display=swap" rel="stylesheet">
    <style>
        :root { --p: #a855f7; --bg: #000; --c: #0a0a0c; --b: rgba(255,255,255,0.05); --s: #10b981; --e: #ef4444; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; }
        body { background: var(--bg); color: #fff; height: 100vh; overflow: hidden; }
        
        #stage { height: 100vh; overflow-y: auto; padding: 20px 20px 120px; }
        .view { display: none; flex-direction: column; }
        .view.active { display: flex; }
        
        .card { background: var(--c); border: 1px solid var(--b); border-radius: 24px; padding: 20px; margin-bottom: 15px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .stat { background: #111; padding: 15px; border-radius: 18px; text-align: center; border: 1px solid var(--b); }
        .stat b { display: block; font-family: 'Orbitron'; font-size: 18px; margin-top: 5px; }

        .trigger { width: 200px; height: 200px; background: radial-gradient(circle, #c084fc, #7e22ce); border-radius: 50%; margin: 40px auto; display: flex; align-items: center; justify-content: center; font-size: 80px; cursor: pointer; box-shadow: 0 0 50px rgba(168,85,247,0.4); transition: 0.1s; }
        .trigger:active { transform: scale(0.9); }

        .btn { width: 100%; padding: 15px; border-radius: 15px; border: none; font-weight: 800; cursor: pointer; transition: 0.2s; background: var(--p); color: #fff; }
        .btn-s { background: var(--s); } .btn-e { background: var(--e); }
        
        nav { position: fixed; bottom: 0; width: 100%; height: 85px; background: rgba(5,5,5,0.95); border-top: 1px solid var(--b); display: flex; justify-content: space-around; align-items: center; padding-bottom: 10px; }
        .tab { color: #444; display: flex; flex-direction: column; align-items: center; font-size: 10px; font-weight: 800; }
        .tab.active { color: var(--p); }

        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 9999; padding: 20px; }
        .modal-in { background: #050505; border: 2px solid var(--p); border-radius: 30px; padding: 25px; width: 100%; max-width: 400px; }
        input { width: 100%; padding: 12px; background: #111; border: 1px solid #222; color: #fff; border-radius: 10px; margin: 10px 0; text-align: center; }
    </style>
</head>
<body>

<div id="intel-modal" class="modal">
    <div class="modal-in">
        <h2 id="m-name" class="orbitron" style="text-align:center">ADMIN_OS</h2>
        <div class="grid" style="margin-top:15px">
            <div class="stat"><small>Spyder</small><b id="m-bal">0</b></div>
            <div class="stat"><small>USDT</small><b id="m-usdt">0</b></div>
        </div>
        <input type="number" id="m-amt" placeholder="Miktar">
        <div class="grid">
            <button onclick="Admin.mod('bal','add')" class="btn btn-s">S. EKLE</button>
            <button onclick="Admin.mod('bal','sub')" class="btn btn-e">S. Sƒ∞L</button>
            <button onclick="Admin.mod('usdt','add')" class="btn btn-s">U. EKLE</button>
            <button onclick="Admin.mod('usdt','sub')" class="btn btn-e">U. Sƒ∞L</button>
        </div>
        <button onclick="Admin.close()" class="btn" style="background:#222; margin-top:10px">KAPAT</button>
    </div>
</div>

<div id="stage">
    <section id="v-1" class="view active">
        <div class="grid">
            <div class="stat"><small>SPYDER</small><b id="u-bal">0</b></div>
            <div class="stat"><small>USDT</small><b id="u-usdt" style="color:var(--s)">$0.00</b></div>
        </div>
        <div class="trigger" onclick="App.tap()">üï∑Ô∏è</div>
        <div class="card">
            <div style="display:flex;justify-content:space-between;font-size:10px;font-weight:900;margin-bottom:8px">
                <span>ENERGY</span><span id="u-nrg-t">1000/1000</span>
            </div>
            <div style="height:8px;background:#000;border-radius:4px;overflow:hidden;border:1px solid var(--b)">
                <div id="u-nrg-b" style="width:100%;height:100%;background:var(--p)"></div>
            </div>
        </div>
    </section>

    <section id="v-2" class="view">
        <h2 class="orbitron">G√ñREVLER</h2>
        <div class="card" style="display:flex;justify-content:space-between;align-items:center">
            <div><b>Telegram</b><br><small style="color:var(--p)">+50K Spyder</small></div>
            <button onclick="App.task('t1',50000)" class="btn" style="width:auto;padding:8px 15px">YAP</button>
        </div>
    </section>

    <section id="v-3" class="view">
        <h2 class="orbitron">REFERANS</h2>
        <div class="card" style="text-align:center">
            <p>Her davet 25K Spyder</p>
            <div id="ref-l" class="stat" style="margin:15px 0; font-size:10px; word-break:break-all">...</div>
            <button onclick="App.copy()" class="btn">KOPYALA</button>
        </div>
    </section>

    <section id="v-4" class="view">
        <h2 class="orbitron" style="color:var(--p)">ADMƒ∞N</h2>
        <div id="adm-l" style="margin-top:15px"></div>
    </section>
</div>

<nav>
    <div class="tab active" onclick="Nav.go('v-1',this)"><i>üéÆ</i><span>OYNA</span></div>
    <div class="tab" onclick="Nav.go('v-2',this)"><i>üì°</i><span>G√ñREV</span></div>
    <div class="tab" onclick="Nav.go('v-3',this)"><i>üë•</i><span>REF</span></div>
    <div id="a-btn" class="tab" style="display:none" onclick="Nav.go('v-4',this);Admin.init()"><i>üîë</i><span>ADM</span></div>
</nav>

<script>
const ADMIN = "8392479231";
const cfg = {
    apiKey: "AIzaSyC18uinYQT9vOC-nhxv3x1WIhO_we3CRMY",
    projectId: "pdfkaynak-51615",
    appId: "1:228512804576:web:a0bba02ca83b4fa7adea85"
};
firebase.initializeApp(cfg);
const db = firebase.firestore();
const tg = window.Telegram.WebApp;
let user = { bal:0, usdt:0, nrg:1000, tasks:[] };
let uid = tg.initDataUnsafe?.user?.id?.toString() || "dev";

const App = {
    init: async () => {
        const d = await db.collection("users").doc(uid).get();
        if(d.exists) user = {...user, ...d.data()};
        if(uid === ADMIN) document.getElementById('a-btn').style.display='flex';
        document.getElementById('ref-l').innerText = `https://t.me/Bot?start=${uid}`;
        setInterval(() => { if(user.nrg < 1000) { user.nrg = Math.min(1000, user.nrg+15); UI(); }}, 3000);
        UI();
    },
    tap: () => {
        if(user.nrg < 2) return;
        user.bal++; user.nrg -= 2; UI();
        if(user.bal % 30 === 0) App.save();
    },
    save: () => db.collection("users").doc(uid).set({...user, name: tg.initDataUnsafe?.user?.first_name || "User", last: Date.now()}, {merge:true}),
    task: (id, r) => {
        if(user.tasks.includes(id)) return;
        user.bal += r; user.tasks.push(id); App.save(); UI(); tg.showAlert("√ñd√ºl Alƒ±ndƒ±!");
    },
    copy: () => {
        const t = document.createElement("textarea"); t.value = document.getElementById('ref-l').innerText;
        document.body.appendChild(t); t.select(); document.execCommand("copy"); document.body.removeChild(t);
        tg.showAlert("Kopyalandƒ±!");
    }
};

const Admin = {
    users: [],
    init: async () => {
        const s = await db.collection("users").get();
        Admin.users = []; s.forEach(d => Admin.users.push({id:d.id, ...d.data()}));
        const l = document.getElementById('adm-l'); l.innerHTML = "";
        Admin.users.forEach(u => {
            l.innerHTML += `<div class="card" style="display:flex;justify-content:space-between" onclick="Admin.open('${u.id}')">
                <span>${u.name}</span><b>${u.bal.toLocaleString()}</b>
            </div>`;
        });
    },
    open: (id) => {
        Admin.sel = Admin.users.find(x => x.id === id);
        document.getElementById('m-name').innerText = Admin.sel.name;
        document.getElementById('m-bal').innerText = Admin.sel.bal.toLocaleString();
        document.getElementById('m-usdt').innerText = Admin.sel.usdt;
        document.getElementById('intel-modal').style.display = 'flex';
    },
    mod: async (type, mode) => {
        const val = parseFloat(document.getElementById('m-amt').value) || 0;
        const final = mode === 'add' ? val : -val;
        await db.collection("users").doc(Admin.sel.id).update({ [type]: firebase.firestore.FieldValue.increment(final) });
        Admin.close(); Admin.init(); tg.showAlert("ƒ∞≈ülem Ba≈üarƒ±lƒ±");
    },
    close: () => document.getElementById('intel-modal').style.display='none'
};

const Nav = {
    go: (id, el) => {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.getElementById(id).classList.add('active'); el.classList.add('active');
    }
};

function UI() {
    document.getElementById('u-bal').innerText = user.bal.toLocaleString();
    document.getElementById('u-usdt').innerText = "$" + user.usdt.toFixed(2);
    document.getElementById('u-nrg-t').innerText = `${user.nrg}/1000`;
    document.getElementById('u-nrg-b').style.width = (user.nrg/10) + "%";
}

App.init();
</script>
</body>
</html>

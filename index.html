<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AnimeBtc: Sudden Death Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&family=Inter:wght@400;900&display=swap" rel="stylesheet">
    <style>
        :root { --pink: #ff4d94; --gold: #ffcc00; --bg: #050505; --red: #ff3b30; }
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: white; font-family: 'Inter', sans-serif; overflow: hidden; height: 100vh; }

        /* UI */
        .header { height: 70px; padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; background: #000; border-bottom: 2px solid #111; }
        .stat-val { font-family: 'Orbitron'; color: var(--gold); font-size: 14px; }
        
        .page { position: absolute; inset: 70px 0 80px 0; padding: 20px; overflow-y: auto; display: none; }
        .page.active { display: block; }

        /* GAME */
        #game-layer { position: fixed; inset: 0; background: radial-gradient(circle, #1a0505 0%, #000 100%); z-index: 1000; display: none; }
        #game-canvas { width: 100%; height: 100%; }
        .hud { position: absolute; top: 30px; width: 100%; text-align: center; pointer-events: none; }
        #score-ui { font-size: 70px; font-family: 'Orbitron'; text-shadow: 0 0 20px var(--pink); }

        /* CARDS */
        .card-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .card { background: #111; padding: 15px; border-radius: 20px; border: 1px solid #222; text-align: center; }
        .card:active { transform: scale(0.95); }

        /* NAV */
        .nav { position: fixed; bottom: 0; width: 100%; height: 80px; background: #000; display: flex; justify-content: space-around; align-items: center; border-top: 1px solid #111; }
        .nav-item { color: #444; font-size: 11px; font-weight: 900; }
        .nav-item.active { color: var(--pink); }

        .big-play { width: 130px; height: 130px; border-radius: 50%; background: var(--pink); color: white; border: none; font-weight: 900; font-size: 20px; box-shadow: 0 0 40px rgba(255, 77, 148, 0.4); margin: 60px auto; display: block; }
        
        #toast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: var(--pink); padding: 12px 25px; border-radius: 50px; font-weight: 900; display: none; z-index: 2000; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
    </style>
</head>
<body>

<div id="toast"></div>

<header class="header">
    <div><p style="font-size:10px;color:#555">SAATLÄ°K</p><span class="stat-val" id="p-ui">+0</span></div>
    <div style="text-align:right"><p style="font-size:10px;color:#555">BAKÄ°YE</p><span class="stat-val" id="b-ui">0</span></div>
</header>

<div id="game-layer">
    <div class="hud"><div id="score-ui">0</div><div id="timer-ui">30s</div></div>
    <canvas id="game-canvas"></canvas>
</div>

<main id="home" class="page active">
    <div style="text-align: center; margin-top: 30px;">
        <h1 style="font-size: 50px; font-family: 'Orbitron';" id="main-b-ui">0</h1>
        <p style="color: #444; font-weight: 900; letter-spacing: 3px;">$ANIMEBTC</p>
        <button class="big-play" onclick="game.init()">PLAY</button>
    </div>
</main>

<main id="mine" class="page">
    <div class="card-grid" id="card-list"></div>
</main>

<nav class="nav">
    <div class="nav-item active" onclick="tab('home', this)">ANA SAYFA</div>
    <div class="nav-item" onclick="tab('mine', this)">KARTLAR</div>
</nav>

<script>
    let db = JSON.parse(localStorage.getItem('animeData')) || {
        bal: 0, profit: 0, last: Date.now(),
        cards: [
            { id: 1, n: "GiriÅŸ Seviye GPU", lvl: 0, p: 150, g: 10 },
            { id: 2, n: "Asic Miner V1", lvl: 0, p: 800, g: 55 },
            { id: 3, n: "Anime Sunucu", lvl: 0, p: 4000, g: 250 }
        ]
    };

    const save = () => localStorage.setItem('animeData', JSON.stringify(db));

    const game = {
        canvas: document.getElementById('game-canvas'),
        ctx: document.getElementById('game-canvas').getContext('2d'),
        items: [], score: 0, running: false, timer: 30,
        
        init() {
            this.running = true; this.score = 0; this.items = []; this.timer = 30;
            document.getElementById('game-layer').style.display = 'block';
            this.canvas.width = window.innerWidth; this.canvas.height = window.innerHeight;
            this.tick();
            this.clock = setInterval(() => {
                this.timer--;
                document.getElementById('timer-ui').innerText = this.timer + "s";
                if(this.timer <= 0) this.over("SÃ¼re Bitti!");
            }, 1000);
        },

        spawn() {
            if(Math.random() < 0.06) {
                this.items.push({ 
                    x: Math.random() * (this.canvas.width - 40) + 20, 
                    y: -50, 
                    t: Math.random() < 0.15 ? 'ðŸ’£' : 'ðŸŒ¸', 
                    v: Math.random() * 3 + 3 
                });
            }
        },

        tick() {
            if(!this.running) return;
            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
            this.spawn();
            this.items.forEach((item, i) => {
                item.y += item.v;
                this.ctx.font = "45px Arial";
                this.ctx.fillText(item.t, item.x, item.y);
                if(item.y > this.canvas.height) this.items.splice(i, 1);
            });
            requestAnimationFrame(() => this.tick());
        },

        over(msg) {
            this.running = false;
            clearInterval(this.clock);
            document.getElementById('game-layer').style.display = 'none';
            db.bal += this.score;
            notify(msg + " +" + this.score);
            refresh(); save();
        }
    };

    function handleTouch(e) {
        if(!game.running) return;
        const tx = e.touches[0].clientX; const ty = e.touches[0].clientY;
        game.items.forEach((it, i) => {
            if(Math.hypot(it.x - tx, it.y - ty) < 65) {
                if(it.t === 'ðŸŒ¸') {
                    game.score += 1; // Ã‡iÃ§ek +1 Puan
                    document.getElementById('score-ui').innerText = game.score;
                    game.items.splice(i, 1); // Ã‡iÃ§ek kaybolur
                } else {
                    game.over("BOOM! PatladÄ±n!"); // Bombaya basÄ±nca oyun biter
                }
            }
        });
    }

    function refresh() {
        document.getElementById('b-ui').innerText = Math.floor(db.bal).toLocaleString();
        document.getElementById('main-b-ui').innerText = Math.floor(db.bal).toLocaleString();
        document.getElementById('p-ui').innerText = "+" + db.profit + "/sa";
    }

    function tab(p, el) {
        document.querySelectorAll('.page').forEach(x => x.classList.remove('active'));
        document.getElementById(p).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(x => x.classList.remove('active'));
        el.classList.add('active');
        if(p === 'mine') {
            const list = document.getElementById('card-list'); list.innerHTML = '';
            db.cards.forEach(c => {
                let cost = Math.floor(c.p * Math.pow(1.6, c.lvl));
                list.innerHTML += `<div class="card" onclick="buy(${c.id})">
                    <p style="font-size:10px;color:var(--pink)">LVL ${c.lvl}</p>
                    <p style="font-weight:900;margin:5px 0">${c.n}</p>
                    <p style="color:var(--up);font-size:11px">+${c.g * (c.lvl+1)}/sa</p>
                    <p style="color:var(--gold);margin-top:10px">ðŸ’° ${cost}</p>
                </div>`;
            });
        }
    }

    function buy(id) {
        let c = db.cards.find(x => x.id === id);
        let cost = Math.floor(c.p * Math.pow(1.6, c.lvl));
        if(db.bal >= cost) {
            db.bal -= cost; db.profit += c.g; c.lvl++;
            tab('mine', document.querySelectorAll('.nav-item')[1]); refresh(); save();
        } else { notify("Yetersiz Bakiye!"); }
    }

    function notify(m) {
        const t = document.getElementById('toast');
        t.innerText = m; t.style.display = 'block';
        setTimeout(() => t.style.display = 'none', 2500);
    }

    setInterval(() => { if(db.profit > 0) { db.bal += (db.profit/3600); refresh(); } }, 1000);

    window.onload = () => {
        let off = (Date.now() - db.last) / 1000;
        let gain = (db.profit / 3600) * off;
        if(gain > 1) { db.bal += gain; notify("Ã‡evrimdÄ±ÅŸÄ± kazanÃ§: " + Math.floor(gain)); }
        db.last = Date.now(); refresh();
    };

    window.addEventListener('touchstart', handleTouch);
    window.onbeforeunload = () => { db.last = Date.now(); save(); };
</script>
</body>
</html>

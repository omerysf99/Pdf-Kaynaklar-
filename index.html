<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Earn Tether Premium - Admin 8392479231</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

    <style>
        :root { --primary: #00ffa3; --bg: #0a0a0a; --card: #151515; --text: #fff; --border: #222; --binance: #f3ba2f; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: var(--text); height: 100vh; display: flex; justify-content: center; overflow: hidden; }
        .app { width: 100%; max-width: 414px; height: 100vh; position: relative; display: flex; flex-direction: column; border: 1px solid var(--border); }
        
        header { padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; background: #000; border-bottom: 1px solid var(--border); }
        .viewport { flex: 1; overflow-y: auto; padding: 15px 15px 110px; scrollbar-width: none; }
        .viewport::-webkit-scrollbar { display: none; }

        /* Mining Card */
        .m-card { background: #1a2f28 url('https://www.transparenttextures.com/patterns/carbon-fibre.png'); border-radius: 25px; padding: 35px 20px; text-align: center; border: 1px solid rgba(0,255,163,0.2); }
        .p-val { font-size: 40px; font-weight: 900; color: var(--primary); font-family: monospace; margin: 15px 0; }
        .orb { width: 110px; height: 110px; background: rgba(0,255,163,0.1); border: 4px solid var(--primary); border-radius: 50%; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 30px var(--primary); animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }

        /* Balance & Action Buttons */
        .btn { width: 100%; padding: 16px; border-radius: 14px; border: none; font-weight: 800; cursor: pointer; font-size: 15px; transition: 0.2s; }
        .btn-w { background: #fff; color: #000; margin-bottom: 10px; }
        .btn-p { background: var(--primary); color: #000; }
        
        .wal-card { background: var(--card); padding: 20px; border-radius: 22px; border: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; margin-top: 15px; }

        /* Task Module */
        .task-list { margin-top: 25px; }
        .task { background: var(--card); padding: 15px; border-radius: 18px; display: flex; align-items: center; gap: 15px; border: 1px solid var(--border); margin-bottom: 12px; transition: 0.3s; }
        .task.done { opacity: 0.3; pointer-events: none; filter: grayscale(1); }
        .t-icon { width: 45px; height: 45px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 22px; }
        .t-btn { background: var(--primary); color: #000; border: none; padding: 8px 18px; border-radius: 20px; font-weight: 900; font-size: 11px; }

        /* Friends Banner */
        .ref-banner { background: linear-gradient(90deg, #1d976c, #00ffa3); border-radius: 22px; padding: 30px; color: #000; position: relative; cursor: pointer; margin-top: 15px; }
        .hand { position: absolute; right: 20px; bottom: -8px; font-size: 45px; animation: wave 1.5s infinite; }
        @keyframes wave { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-12px); } }

        /* Navigation */
        nav { position: absolute; bottom: 0; width: 100%; height: 85px; background: #000; border-top: 1px solid var(--border); display: flex; justify-content: space-around; padding-top: 15px; }
        .n-item { color: #888; text-align: center; font-size: 11px; cursor: pointer; flex: 1; }
        .n-item.active { color: #fff; }
        .n-item i { font-size: 24px; display: block; margin-bottom: 4px; }

        .view { display: none; } .view.active { display: block; }

        /* Modal */
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: none; justify-content: center; align-items: center; z-index: 1000; }
        .m-box { background: var(--card); width: 85%; padding: 30px; border-radius: 25px; border: 1px solid var(--border); text-align: center; }
        input { width: 100%; padding: 15px; background: #000; border: 1px solid var(--border); color: #fff; border-radius: 12px; margin: 15px 0; outline: none; text-align: center; }
    </style>
</head>
<body>

<div class="app">
    <header>
        <div style="font-size:14px; opacity:0.7;"><i class="fas fa-times"></i> Kapat</div>
        <div style="font-weight:900;">Earn Tether <i class="fas fa-check-circle" style="color:#3897f0;"></i></div>
        <i class="fas fa-cog"></i>
    </header>

    <div class="viewport">
        <div id="v-home" class="view active">
            <div class="m-card">
                <div class="p-val" id="p_pool">0.00000000</div>
                <div class="orb"><img src="https://cryptologos.cc/logos/tether-usdt-logo.png?v=025" width="55"></div>
                <button class="btn btn-w" onclick="collectPool()">KazancÄ± Topla</button>
                <button class="btn btn-p" style="background:rgba(255,255,255,0.1); color:#fff;" onclick="alert('Pek YakÄ±nda!')">HÄ±zlandÄ±rÄ±cÄ± Al</button>
            </div>

            <div class="wal-card">
                <div><div id="p_wallet" style="font-weight:900; font-size:20px;">0.000000</div><div style="font-size:11px; color:#888;">CÃ¼zdan Bakiyesi (USDT)</div></div>
                <button class="t-btn" style="padding:10px 20px;" onclick="openW()">Para Ã‡ek</button>
            </div>

            <div class="task-list">
                <h4 style="margin-bottom:15px;">Para KazandÄ±ran GÃ¶revler</h4>
                
                <div class="task" id="t-bin">
                    <div class="t-icon" style="background:var(--binance); color:#000;"><i class="fab fa-bitcoin"></i></div>
                    <div style="flex:1;"><b>Binance News</b><br><small style="color:var(--primary);">+0.05 $USDT</small></div>
                    <button class="t-btn" onclick="doTask('bin', 0.05, 'https://t.me/BinanceBrazilNews')">KATIL</button>
                </div>

                <div class="task" id="t-tg">
                    <div class="t-icon" style="background:#24A1DE;"><i class="fab fa-telegram-plane"></i></div>
                    <div style="flex:1;"><b>Resmi Kanal</b><br><small style="color:var(--primary);">+0.05 $USDT</small></div>
                    <button class="t-btn" onclick="doTask('tg', 0.05, 'https://t.me/earntether2026')">KATIL</button>
                </div>

                <div class="task">
                    <div class="t-icon" style="background:#ff4757;"><i class="fas fa-video"></i></div>
                    <div style="flex:1;"><b>Video Reklam</b><br><small id="ad_txt">Kalan: 20/20 (+0.0003)</small></div>
                    <button class="t-btn" onclick="watchAd()">Ä°ZLE</button>
                </div>
            </div>
        </div>

        <div id="v-friends" class="view">
            <div class="ref-banner" onclick="copyRef()">
                <h3 style="font-weight:900;">Ekibini Kur</h3>
                <p style="font-size:13px; font-weight:700;">Her davet iÃ§in bonus kazanÄ±n!</p>
                <div class="hand">ðŸ‘†</div>
            </div>
            <div class="wal-card" style="flex-direction:column; padding:30px; text-align:center;">
                <p style="color:#888; font-size:12px; margin-bottom:10px;">DAVET LÄ°NKÄ°NÄ°Z:</p>
                <div id="ref_url" style="color:var(--primary); font-size:11px; word-break:break-all; font-weight:800; border:1px dashed var(--border); padding:15px; border-radius:15px; width:100%;">YÃ¼kleniyor...</div>
            </div>
        </div>
    </div>

    <div class="modal" id="wModal">
        <div class="m-box">
            <h2 style="font-weight:900;">Para Ã‡ekme</h2>
            <p style="font-size:12px; color:#888; margin-top:5px;">Minimum Ã‡ekim: 5.00 USDT</p>
            <input type="text" id="wAddr" placeholder="BEP20 / TRC20 CÃ¼zdan Adresi">
            <input type="number" id="wAmt" placeholder="Miktar (Ã–rn: 5.50)">
            <button class="btn btn-p" onclick="sendW()">Talebi GÃ¶nder</button>
            <button class="btn" style="background:transparent; color:#888;" onclick="closeW()">VazgeÃ§</button>
        </div>
    </div>

    <nav>
        <div class="n-item active" onclick="tab('v-home', this)"><i class="fas fa-home"></i>Ev</div>
        <div class="n-item" onclick="tab('v-friends', this)"><i class="fas fa-users"></i>Ekip</div>
    </nav>
</div>

<script>
    // --- FIREBASE BAÄžLANTISI ---
    const firebaseConfig = {
        apiKey: "AIzaSyAIstjXKAAgVr-AyVY-a1tlab-TquP1EwI",
        authDomain: "sanakod-e6b22.firebaseapp.com",
        projectId: "sanakod-e6b22",
        storageBucket: "sanakod-e6b22.firebasestorage.app",
        messagingSenderId: "567585215373",
        appId: "1:567585215373:web:d4ec6e5541da2872df63c4"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    
    // KullanÄ±cÄ± ID: Admin ID 8392479231 (Sistem her giriÅŸte bu ID'yi baz alÄ±r)
    const USER_ID = "8392479231";
    const RATE = 0.000001; 

    let acc = { pool: 0, wallet: 0, tasks: [], ads: 20, last: Date.now() };

    // --- BAÅžLATMA VE NaN KORUMASI ---
    async function init() {
        document.getElementById('ref_url').innerText = "https://t.me/EarnTetherBot?start=" + USER_ID;

        try {
            const doc = await db.collection('users').doc(USER_ID).get();
            if(doc.exists) {
                const data = doc.data();
                // Verileri Number() ile Ã§ekerek NaN hatasÄ±nÄ± engelliyoruz
                acc.pool = Number(data.pool) || 0;
                acc.wallet = Number(data.wallet) || 0;
                acc.ads = data.ads !== undefined ? data.ads : 20;
                acc.tasks = data.tasks || [];
                acc.last = Number(data.last) || Date.now();

                // Ã‡evrimdÄ±ÅŸÄ± geÃ§en sÃ¼reyi hesapla ve bakiyeye ekle
                const diff = (Date.now() - acc.last) / 1000;
                acc.pool += (diff * RATE);
            }
            acc.tasks.forEach(t => document.getElementById('t-'+t)?.classList.add('done'));
            updateUI();
            setInterval(loop, 100);
        } catch(e) { console.error(e); setInterval(loop, 100); }
    }

    function loop() {
        if(isNaN(acc.pool)) acc.pool = 0; // Acil durum NaN Ã¶nleyici
        acc.pool += (RATE / 10);
        document.getElementById('p_pool').innerText = acc.pool.toFixed(8);
        if(Math.random() > 0.99) save();
    }

    function updateUI() {
        const walVal = Number(acc.wallet) || 0;
        document.getElementById('p_wallet').innerText = walVal.toFixed(6);
        document.getElementById('ad_txt').innerText = `Kalan: ${acc.ads}/20 (+0.0003)`;
    }

    async function save() {
        acc.last = Date.now();
        await db.collection('users').doc(USER_ID).set(acc);
    }

    async function collectPool() {
        if(acc.pool < 0.00001) return;
        acc.wallet += acc.pool;
        acc.pool = 0;
        updateUI();
        await save();
        alert("Toplama baÅŸarÄ±lÄ±!");
    }

    function openW() { document.getElementById('wModal').style.display = 'flex'; }
    function closeW() { document.getElementById('wModal').style.display = 'none'; }

    async function sendW() {
        const addr = document.getElementById('wAddr').value;
        const amt = parseFloat(document.getElementById('wAmt').value);
        if(amt < 5 || isNaN(amt)) return alert("Minimum 5$ Ã§ekilebilir.");
        if(amt > acc.wallet) return alert("Yetersiz bakiye.");

        await db.collection('withdrawals').add({
            uid: USER_ID, address: addr, amount: amt, date: new Date(), status: "Beklemede"
        });

        acc.wallet -= amt;
        closeW();
        updateUI();
        await save();
        alert("Ã‡ekim talebi kaydedildi!");
    }

    function doTask(id, rew, link) {
        window.open(link, '_blank');
        setTimeout(async () => {
            if(!acc.tasks.includes(id)) {
                acc.wallet += rew;
                acc.tasks.push(id);
                document.getElementById('t-'+id).classList.add('done');
                updateUI();
                await save();
            }
        }, 3000);
    }

    function watchAd() {
        if(acc.ads <= 0) return alert("BugÃ¼nkÃ¼ limit doldu.");
        alert("Reklam oynatÄ±lÄ±yor (10sn)...");
        setTimeout(async () => {
            acc.wallet += 0.0003;
            acc.ads--;
            updateUI();
            await save();
        }, 10000);
    }

    function tab(id, el) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.n-item').forEach(n => n.classList.remove('active'));
        el.classList.add('active');
    }

    function copyRef() {
        const link = "https://t.me/EarnTetherBot?start=" + USER_ID;
        navigator.clipboard.writeText(link);
        alert("Link kopyalandÄ±!");
    }

    window.onload = init;
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Earn Tether Pro v12.0 - Advanced Ref System</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;600;800&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

    <style>
        :root {
            --neon: #00ffa3;
            --neon-soft: rgba(0, 255, 163, 0.1);
            --dark-core: #010503;
            --glass-border: rgba(0, 255, 163, 0.3);
            --surface: rgba(255, 255, 255, 0.03);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Exo 2', sans-serif; user-select: none; }
        body { background: var(--dark-core); color: #fff; height: 100vh; overflow: hidden; display: flex; justify-content: center; }

        .app-frame {
            width: 100%; max-width: 450px; height: 100vh; position: relative;
            background: radial-gradient(circle at top, #0a2b1e 0%, #010503 80%);
            display: flex; flex-direction: column; overflow: hidden;
        }

        /* Navigasyon & Header */
        .top-nav {
            padding: 20px; display: flex; justify-content: space-between; align-items: center;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(20px); border-bottom: 1px solid var(--glass-border);
        }
        .app-title { font-family: 'Orbitron'; font-weight: 900; color: var(--neon); font-size: 13px; letter-spacing: 2px; }
        .user-id-badge { font-size: 10px; background: var(--neon-soft); border: 1px solid var(--neon); padding: 4px 10px; border-radius: 6px; color: var(--neon); font-weight: 800; }

        .content-scroll { flex: 1; overflow-y: auto; padding: 20px; padding-bottom: 110px; }
        .content-scroll::-webkit-scrollbar { display: none; }

        /* Ana Kart Tasarımı */
        .stat-card {
            background: var(--surface); border: 1px solid var(--glass-border); border-radius: 30px;
            padding: 30px 20px; text-align: center; margin-bottom: 20px; position: relative;
            box-shadow: 0 15px 35px rgba(0,0,0,0.5);
        }
        .mining-label { font-size: 10px; color: var(--neon); letter-spacing: 5px; font-weight: 800; margin-bottom: 15px; display: block; }
        .big-amount { font-family: 'Orbitron'; font-size: 34px; font-weight: 900; color: #fff; margin-bottom: 25px; }

        /* Görsel Animasyon */
        .visual-engine { width: 140px; height: 140px; margin: 0 auto 30px; position: relative; display: flex; align-items: center; justify-content: center; }
        .engine-ring { position: absolute; width: 100%; height: 100%; border: 1px solid var(--neon); border-radius: 50%; animation: spin 10s linear infinite; opacity: 0.2; }
        .engine-core { 
            width: 80px; height: 80px; background: var(--neon-soft); border: 2px solid var(--neon); border-radius: 50%;
            display: flex; align-items: center; justify-content: center; box-shadow: 0 0 30px var(--neon-soft);
        }
        .engine-core img { width: 45px; }

        /* Butonlar */
        .btn-prime {
            width: 100%; padding: 18px; border-radius: 20px; border: none; font-weight: 900; 
            font-size: 16px; cursor: pointer; transition: 0.3s; background: #fff; color: #000;
        }
        .btn-prime:disabled { background: #1a1a1a; color: #444; }
        .btn-prime:active { transform: scale(0.97); }

        /* Cüzdan Paneli */
        .wallet-mini {
            background: rgba(255,255,255,0.02); border-radius: 20px; padding: 15px 25px;
            display: flex; justify-content: space-between; align-items: center; border: 1px solid #111; margin-bottom: 25px;
        }
        .wallet-mini b { font-family: 'Orbitron'; font-size: 20px; color: var(--neon); }
        .wallet-mini span { font-size: 10px; color: #555; font-weight: 800; display: block; }

        /* Referans Giriş & Kod Bölümü */
        .ref-section { background: linear-gradient(135deg, rgba(0,255,163,0.05) 0%, transparent 100%); border-radius: 25px; padding: 25px; border: 1px solid var(--glass-border); margin-bottom: 20px; }
        .ref-section.completed { opacity: 0.5; filter: grayscale(1); pointer-events: none; }
        .ref-input-box { display: flex; gap: 10px; margin-top: 20px; }
        .ref-input-box input { flex: 1; background: #000; border: 1px solid #222; border-radius: 12px; color: #fff; padding: 12px; text-align: center; font-weight: 700; }
        .btn-apply-code { background: var(--neon); color: #000; border: none; border-radius: 12px; padding: 0 20px; font-weight: 900; }

        /* Liste */
        .friend-row { background: var(--surface); padding: 15px; border-radius: 15px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; border: 1px solid rgba(255,255,255,0.02); }
        .friend-row b { font-size: 13px; color: #ccc; }
        .friend-row span { color: var(--neon); font-weight: 800; font-size: 12px; }

        /* Footer Nav */
        footer {
            position: absolute; bottom: 0; width: 100%; height: 90px;
            background: rgba(0,0,0,0.95); backdrop-filter: blur(25px);
            display: flex; border-top: 1px solid var(--glass-border);
        }
        .nav-link { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #333; transition: 0.3s; }
        .nav-link.active { color: var(--neon); }
        .nav-link i { font-size: 24px; margin-bottom: 5px; }
        .nav-link span { font-size: 10px; font-weight: 800; }

        /* FX */
        .fx-overlay { position: fixed; top:0; left:0; width:100%; height:100%; display:none; align-items:center; justify-content:center; z-index: 1000; pointer-events: none; }
        .fx-notif { background: rgba(0,0,0,0.9); border: 1px solid var(--neon); padding: 25px 40px; border-radius: 20px; text-align: center; animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }

        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes pop { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        .view { display: none; } .view.active { display: block; }
    </style>
</head>
<body>

<div class="app-frame">
    <header class="top-nav">
        <div class="app-title">TETHER CORE</div>
        <div class="user-id-badge" id="my-id-display">ID: 8392479231</div>
    </header>

    <div class="content-scroll">
        <div id="v-mining" class="view active">
            <div class="stat-card">
                <span class="mining-label">CANLI KAZIM HAVUZU</span>
                <div class="big-amount" id="p-val">0.00000000</div>
                
                <div class="visual-engine">
                    <div class="engine-ring"></div>
                    <div class="engine-core">
                        <img src="https://cryptologos.cc/logos/tether-usdt-logo.png?v=025">
                    </div>
                </div>

                <div style="font-size: 11px; color: var(--neon); margin-bottom: 25px; font-weight: 800;">
                    SİSTEM HIZI: 0.000115750 USDT/S
                </div>

                <button class="btn-prime" id="btn-collect" onclick="collectPool()">BAKİYEYİ AKTAR</button>
            </div>

            <div class="wallet-mini">
                <div><span>TOPLAM KAZANÇ</span><b id="w-val">0.000000</b></div>
                <button class="btn-apply-code" style="height: 40px;" onclick="toast('MİNİMUM 10 USDT', false)">ÇEK</button>
            </div>

            <h3 style="font-size: 12px; color: #444; margin-bottom: 12px; letter-spacing: 2px;">AKTİVİTE</h3>
            <div class="friend-row">
                <div style="display:flex; align-items:center; gap:10px;">
                    <i class="fas fa-video" style="color:var(--neon)"></i>
                    <b>Reklam İzle & Kazan</b>
                </div>
                <button class="btn-apply-code" id="btn-ad" onclick="watchAd()" style="font-size:10px; padding: 8px 15px;">İZLE</button>
            </div>
        </div>

        <div id="v-team" class="view">
            <div class="ref-section" id="promo-container">
                <h3 style="font-family: 'Orbitron'; font-size: 14px; color: var(--neon);">REFERANS KODU GİR</h3>
                <p style="font-size: 11px; color: #666; margin-top: 5px;">Arkadaşınızın ID kodunu girerek <b>0.10 USDT</b> hoşgeldin bonusu kazanın.</p>
                <div class="ref-input-box">
                    <input type="number" id="input-ref" placeholder="ID Giriniz (Örn: 8392...)">
                    <button class="btn-apply-code" onclick="processReferral()">ONAYLA</button>
                </div>
            </div>

            <div class="stat-card" style="padding: 25px;">
                <h4 style="font-family: 'Orbitron'; font-size: 16px; color: var(--neon);">SENİN KODUN</h4>
                <div style="background:#000; padding: 15px; border-radius: 12px; border: 1px dashed var(--glass-border); margin: 20px 0; font-family:'Orbitron'; font-weight:900; letter-spacing:3px;">
                    8392479231
                </div>
                <button class="btn-prime" style="background:var(--neon); font-size: 14px;" onclick="copyMyLink()">DAVET LİNKİNİ KOPYALA</button>
            </div>

            <div class="wallet-mini">
                <div><span>DAVET EDİLENLER</span><b id="ref-count-ui">0 KİŞİ</b></div>
                <i class="fas fa-user-plus" style="color:var(--neon); font-size:22px;"></i>
            </div>

            <h3 style="font-size: 12px; color: #444; margin-bottom: 12px; letter-spacing: 2px;">EKİP ÜYELERİ</h3>
            <div id="friends-list-container">
                <div style="text-align:center; padding: 30px; color:#333; font-size:12px;">Henüz kimseyi davet etmediniz.</div>
            </div>
        </div>
    </div>

    <footer>
        <div class="nav-link active" onclick="tab('v-mining', this)"><i class="fas fa-atom"></i><span>KAZIM</span></div>
        <div class="nav-link" onclick="tab('v-team', this)"><i class="fas fa-fingerprint"></i><span>EKİBİM</span></div>
    </footer>

    <div id="fx-wrap" class="fx-overlay">
        <div class="fx-notif">
            <i id="fx-icon" class="fas fa-check-circle" style="font-size: 40px; color: var(--neon); margin-bottom: 15px; display: block;"></i>
            <span id="fx-msg" style="font-family: 'Orbitron'; font-size: 13px; color: var(--neon);">İŞLEM TAMAM</span>
        </div>
    </div>
</div>

<script>
    // FIREBASE INITIALIZATION
    const fbConfig = {
        apiKey: "AIzaSyAIstjXKAAgVr-AyVY-a1tlab-TquP1EwI",
        authDomain: "sanakod-e6b22.firebaseapp.com",
        projectId: "sanakod-e6b22",
        storageBucket: "sanakod-e6b22.firebasestorage.app",
        messagingSenderId: "567585215373",
        appId: "1:567585215373:web:d4ec6e5541da2872df63c4"
    };
    firebase.initializeApp(fbConfig);
    const db = firebase.firestore();

    // APP CONSTANTS
    const ADMIN_ID = "8392479231";
    const SPEED = 0.000115750;
    const MIN_CLAIM = 0.0000001;

    // USER STATE
    let state = {
        pool: 0,
        wallet: 0,
        friends: [],
        inviter: null,
        lastSync: Date.now(),
        lastAd: 0
    };

    // CORE ENGINE
    async function boot() {
        const userDoc = await db.collection('users').doc(ADMIN_ID).get();
        if(userDoc.exists) {
            state = { ...state, ...userDoc.data() };
            const offlineSeconds = (Date.now() - state.lastSync) / 1000;
            state.pool += offlineSeconds * SPEED;
        } else {
            await db.collection('users').doc(ADMIN_ID).set(state);
        }

        if(state.inviter) lockRefUI(state.inviter);
        
        syncUI();
        setInterval(engineTick, 100);
        setInterval(cloudSync, 10000);
        checkAdTimer();
    }

    function engineTick() {
        state.pool += (SPEED / 10);
        document.getElementById('p-val').innerText = state.pool.toFixed(8);
        document.getElementById('btn-collect').disabled = (state.pool < MIN_CLAIM);
    }

    function syncUI() {
        document.getElementById('w-val').innerText = (Number(state.wallet) || 0).toFixed(6);
        document.getElementById('ref-count-ui').innerText = state.friends.length + " KİŞİ";
        
        const container = document.getElementById('friends-list-container');
        if(state.friends.length > 0) {
            container.innerHTML = state.friends.map(f => `
                <div class="friend-row">
                    <b>ID: ${f}</b>
                    <span>+0.10 Bonus Aktif</span>
                </div>
            `).join('');
        }
    }

    async function cloudSync() {
        state.lastSync = Date.now();
        await db.collection('users').doc(ADMIN_ID).set(state);
    }

    function toast(text, success = true) {
        const wrap = document.getElementById('fx-wrap');
        const icon = document.getElementById('fx-icon');
        const msg = document.getElementById('fx-msg');
        
        icon.className = success ? 'fas fa-check-circle' : 'fas fa-times-circle';
        icon.style.color = success ? '#00ffa3' : '#ff4757';
        msg.innerText = text;
        msg.style.color = success ? '#00ffa3' : '#ff4757';
        
        wrap.style.display = 'flex';
        setTimeout(() => wrap.style.display = 'none', 2000);
    }

    // ACTIONS
    function collectPool() {
        if(state.pool >= MIN_CLAIM) {
            state.wallet += state.pool;
            state.pool = 0;
            syncUI(); cloudSync();
            toast('CÜZDANA AKTARILDI');
        }
    }

    function checkAdTimer() {
        const btn = document.getElementById('btn-ad');
        const remaining = Math.floor((state.lastAd + 15000 - Date.now()) / 1000);
        if(remaining > 0) {
            btn.disabled = true;
            btn.innerText = remaining + "s";
            setTimeout(checkAdTimer, 1000);
        } else {
            btn.disabled = false;
            btn.innerText = "İZLE";
        }
    }

    function watchAd() {
        state.lastAd = Date.now();
        toast('REKLAM BAŞLADI...');
        setTimeout(() => {
            state.wallet += 0.0001;
            syncUI(); cloudSync();
            toast('+0.0001 USDT');
            checkAdTimer();
        }, 3000);
    }

    // ********** ADVANCED REFERRAL LOGIC **********
    async function processReferral() {
        const inputId = document.getElementById('input-ref').value.trim();
        
        if(!inputId || inputId === ADMIN_ID) return toast('GEÇERSİZ KOD', false);
        if(state.inviter) return toast('ZATEN KULLANILDI', false);

        toast('KOD DOĞRULANIYOR...');

        try {
            // Veritabanında bu kod (ID) var mı sorgula
            const refDocRef = db.collection('users').doc(inputId);
            const refDoc = await refDocRef.get();

            if(refDoc.exists) {
                const remoteData = refDoc.data();
                
                // 1. Kod Sahibini Güncelle (Ona 0.10 ekle ve bizi listesine ekle)
                const newFriendsList = remoteData.friends || [];
                if(!newFriendsList.includes(ADMIN_ID)) newFriendsList.push(ADMIN_ID);
                
                await refDocRef.update({
                    wallet: (remoteData.wallet || 0) + 0.10,
                    friends: newFriendsList
                });

                // 2. Kendimizi Güncelle (Bize 0.10 ekle ve inviter set et)
                state.wallet += 0.10;
                state.inviter = inputId;
                
                lockRefUI(inputId);
                syncUI();
                await cloudSync();
                
                toast('0.10 USDT KAZANDIN!');
            } else {
                toast('KOD BULUNAMADI', false);
            }
        } catch (e) {
            toast('BAĞLANTI HATASI', false);
        }
    }

    function lockRefUI(id) {
        const container = document.getElementById('promo-container');
        container.classList.add('completed');
        container.innerHTML = `
            <div style="text-align:center;">
                <i class="fas fa-link" style="color:var(--neon); font-size:24px; margin-bottom:10px; display:block;"></i>
                <b style="color:var(--neon)">DAVET EDEN: ${id}</b>
                <p style="font-size:10px; color:#555; margin-top:5px;">Referans bağlantısı başarıyla kuruldu.</p>
            </div>
        `;
    }

    function tab(id, el) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active'));
        el.classList.add('active');
    }

    function copyMyLink() {
        const link = "https://t.me/EarnTetherBot?start=" + ADMIN_ID;
        navigator.clipboard.writeText(link);
        toast('LİNK KOPYALANDI');
    }

    window.onload = boot;
</script>
</body>
</html>

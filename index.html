<!DOCTYPE html>
<html lang="tr" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NexTube Pro | 10s Smart Upload System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap');
        
        :root {
            --accent: #ff0000;
            --bg-dark: #0a0a0a;
            --glass: rgba(15, 15, 15, 0.8);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg-dark);
            color: #eeeeee;
            overflow: hidden;
        }

        /* --- UI Elements --- */
        .glass { backdrop-filter: blur(15px); background: var(--glass); }
        .sidebar-item.active { background: rgba(255,255,255,0.1); border-left: 3px solid var(--accent); color: #fff; }
        
        /* Progress Bar Animation */
        .progress-fill {
            transition: width 0.1s linear;
            background: linear-gradient(90deg, #ff0000, #ff4d4d);
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.4);
        }

        .shorts-container {
            height: calc(100vh - 64px);
            scroll-snap-type: y mandatory;
            overflow-y: scroll;
            scrollbar-width: none;
        }
        .short-slide {
            height: calc(100vh - 64px);
            scroll-snap-align: start;
            display: flex;
            justify-content: center;
            background: #000;
        }

        .fade-in { animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="antialiased">

    <header class="h-16 fixed top-0 w-full glass border-b border-white/5 flex items-center justify-between px-6 z-[100]">
        <div class="flex items-center gap-4">
            <div class="flex items-center gap-2 cursor-pointer" onclick="ui.changePage('home')">
                <div class="bg-red-600 p-1.5 rounded-xl"><i data-lucide="play" class="fill-white text-white w-5 h-5"></i></div>
                <span class="text-xl font-black tracking-tighter">NexTube</span>
            </div>
        </div>
        <div class="flex items-center gap-4">
            <button onclick="ui.openModal('upload')" class="bg-white text-black px-5 py-2 rounded-2xl font-bold text-sm hover:bg-gray-200 flex items-center gap-2 transition active:scale-95">
                <i data-lucide="plus" class="w-4 h-4"></i> <span>YÃœKLE</span>
            </button>
            <div class="w-10 h-10 rounded-full bg-zinc-800 border border-white/10 flex items-center justify-center text-[10px] font-bold">AD</div>
        </div>
    </header>

    <div class="flex pt-16 h-screen">
        <aside class="w-64 hidden lg:flex flex-col p-4 border-r border-white/5 bg-[#0a0a0a]">
            <nav class="space-y-1">
                <button onclick="ui.changePage('home')" id="nav-home" class="sidebar-item active w-full flex items-center gap-4 px-4 py-3 rounded-xl transition text-sm"><i data-lucide="home"></i> Ana Sayfa</button>
                <button onclick="ui.changePage('shorts')" id="nav-shorts" class="sidebar-item w-full flex items-center gap-4 px-4 py-3 rounded-xl transition text-sm"><i data-lucide="zap"></i> Shorts</button>
                <hr class="border-white/5 my-4">
                <div class="px-4 py-2 text-[10px] font-bold text-gray-500 uppercase">Admin: 8392479231</div>
            </nav>
        </aside>

        <main class="flex-1 relative overflow-hidden bg-[#050505]">
            <section id="view-home" class="h-full overflow-y-auto p-8 fade-in">
                <div id="videoGrid" class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-8 pb-20"></div>
            </section>
            <section id="view-shorts" class="hidden h-full bg-black">
                <div id="shortsFlow" class="shorts-container"></div>
            </section>
        </main>
    </div>

    <div id="modalUpload" class="fixed inset-0 z-[200] hidden items-center justify-center bg-black/90 backdrop-blur-xl p-6">
        <div id="uploadContent" class="w-full max-w-xl bg-[#121212] rounded-[40px] border border-white/10 p-10 shadow-2xl">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl font-black">Video YayÄ±nla</h2>
                <button onclick="ui.closeModal('upload')" id="closeUploadBtn" class="p-2 hover:bg-white/5 rounded-full"><i data-lucide="x"></i></button>
            </div>
            
            <div id="uploadForm" class="space-y-6">
                <div class="border-2 border-dashed border-white/10 rounded-[30px] p-10 text-center hover:border-red-600/50 transition cursor-pointer bg-white/[0.02]" onclick="document.getElementById('videoFile').click()">
                    <i data-lucide="video" class="w-12 h-12 mx-auto mb-4 text-gray-500"></i>
                    <p id="videoLabel" class="text-sm font-bold">Dosya SeÃ§in</p>
                    <input type="file" id="videoFile" class="hidden" accept="video/*" onchange="app.handleFileSelect(this)">
                </div>
                <input type="text" id="upTitle" placeholder="Video BaÅŸlÄ±ÄŸÄ±" class="w-full bg-white/5 border border-white/10 rounded-2xl p-4 outline-none focus:border-red-600 transition">
                <button onclick="app.startUpload()" id="startBtn" class="w-full py-5 bg-red-600 rounded-[24px] font-black text-lg hover:bg-red-700 transition shadow-xl shadow-red-600/30">VÄ°DEOYU YÃœKLE</button>
            </div>

            <div id="uploadProgressArea" class="hidden py-10 text-center space-y-6">
                <div class="relative w-24 h-24 mx-auto mb-4">
                    <div class="absolute inset-0 border-4 border-white/5 rounded-full"></div>
                    <div id="circularProgress" class="absolute inset-0 border-4 border-red-600 rounded-full border-t-transparent animate-spin"></div>
                    <div class="absolute inset-0 flex items-center justify-center font-black text-xl" id="percentText">0%</div>
                </div>
                <div class="space-y-2">
                    <h3 class="text-xl font-bold">Video YÃ¼kleniyor...</h3>
                    <p class="text-sm text-gray-500">LÃ¼tfen bu pencereyi kapatmayÄ±n.</p>
                </div>
                <div class="w-full bg-white/5 h-3 rounded-full overflow-hidden border border-white/5">
                    <div id="progressBar" class="progress-fill h-full w-0"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="toast" class="fixed bottom-10 left-1/2 -translate-x-1/2 glass border border-white/10 px-8 py-4 rounded-2xl shadow-2xl z-[300] hidden items-center gap-3 fade-in">
        <i data-lucide="check-circle" class="text-green-500"></i>
        <span class="font-bold" id="toastMsg">Video baÅŸarÄ±yla yÃ¼klendi!</span>
    </div>

    <canvas id="thumbCanvas" class="hidden"></canvas>

    <script>
        let videos = [];
        
        const app = {
            tempFile: null,
            tempAutoThumb: null,

            handleFileSelect(input) {
                const file = input.files[0];
                if (!file) return;
                this.tempFile = file;
                document.getElementById('videoLabel').innerText = file.name;

                // Arka planda thumbnail hazÄ±rla
                const video = document.createElement('video');
                video.src = URL.createObjectURL(file);
                video.onloadeddata = () => { video.currentTime = 2; };
                video.onseeked = () => {
                    const canvas = document.getElementById('thumbCanvas');
                    canvas.width = 640; canvas.height = 360;
                    canvas.getContext('2d').drawImage(video, 0, 0, 640, 360);
                    this.tempAutoThumb = canvas.toDataURL('image/jpeg');
                };
            },

            startUpload() {
                const title = document.getElementById('upTitle').value;
                if (!this.tempFile || !title) return alert("Dosya ve baÅŸlÄ±k zorunludur!");

                // UI Kilitle
                document.getElementById('uploadForm').classList.add('hidden');
                document.getElementById('uploadProgressArea').classList.remove('hidden');
                document.getElementById('closeUploadBtn').classList.add('hidden');
                
                let progress = 0;
                const duration = 10000; // 10 Saniye
                const interval = 100; // 100ms
                const step = 100 / (duration / interval);

                const timer = setInterval(() => {
                    progress += step;
                    if (progress >= 100) {
                        progress = 100;
                        clearInterval(timer);
                        this.completeUpload();
                    }
                    this.updateUI(progress);
                }, interval);
            },

            updateUI(val) {
                const percent = Math.floor(val);
                document.getElementById('progressBar').style.width = percent + '%';
                document.getElementById('percentText').innerText = percent + '%';
            },

            completeUpload() {
                const title = document.getElementById('upTitle').value;
                const url = URL.createObjectURL(this.tempFile);
                
                const tempV = document.createElement('video');
                tempV.src = url;
                tempV.onloadedmetadata = () => {
                    const newVideo = {
                        id: Date.now(),
                        title: title,
                        url: url,
                        thumb: this.tempAutoThumb,
                        type: tempV.duration <= 60 ? 'short' : 'long',
                        duration: tempV.duration
                    };
                    videos.unshift(newVideo);
                    
                    // BaÅŸarÄ± UI
                    ui.showToast("Video baÅŸarÄ±yla yÃ¼klendi! ðŸš€");
                    setTimeout(() => {
                        ui.closeModal('upload');
                        ui.renderAll();
                        this.reset();
                    }, 1000);
                };
            },

            reset() {
                this.tempFile = null;
                this.tempAutoThumb = null;
                document.getElementById('upTitle').value = "";
                document.getElementById('videoFile').value = "";
                document.getElementById('videoLabel').innerText = "Dosya SeÃ§in";
                document.getElementById('uploadForm').classList.remove('hidden');
                document.getElementById('uploadProgressArea').classList.add('hidden');
                document.getElementById('closeUploadBtn').classList.remove('hidden');
                document.getElementById('progressBar').style.width = '0%';
            }
        };

        const ui = {
            currentPage: 'home',
            changePage(page) {
                this.currentPage = page;
                document.getElementById('view-home').classList.toggle('hidden', page !== 'home');
                document.getElementById('view-shorts').classList.toggle('hidden', page !== 'shorts');
                this.renderAll();
            },
            openModal(id) { document.getElementById('modal' + id.charAt(0).toUpperCase() + id.slice(1)).classList.replace('hidden', 'flex'); },
            closeModal(id) { document.getElementById('modal' + id.charAt(0).toUpperCase() + id.slice(1)).classList.replace('flex', 'hidden'); },
            
            showToast(msg) {
                const t = document.getElementById('toast');
                document.getElementById('toastMsg').innerText = msg;
                t.classList.replace('hidden', 'flex');
                setTimeout(() => t.classList.replace('flex', 'hidden'), 3000);
            },

            renderAll() {
                const grid = document.getElementById('videoGrid');
                const flow = document.getElementById('shortsFlow');
                
                grid.innerHTML = videos.filter(v => v.type === 'long').map(v => `
                    <div class="group cursor-pointer">
                        <div class="relative aspect-video rounded-2xl overflow-hidden bg-zinc-900 border border-white/5">
                            <img src="${v.thumb}" class="w-full h-full object-cover">
                            <div class="absolute bottom-2 right-2 bg-black/80 px-2 py-1 rounded text-[10px] font-bold">${Math.floor(v.duration)}s</div>
                        </div>
                        <h3 class="mt-3 font-bold text-sm">${v.title}</h3>
                    </div>
                `).join('');

                flow.innerHTML = videos.filter(v => v.type === 'short').map(v => `
                    <div class="short-slide">
                        <div class="relative h-[90%] mt-[2%] aspect-[9/16] rounded-[30px] overflow-hidden bg-zinc-900 border border-white/5 shadow-2xl">
                            <video src="${v.url}" controls class="w-full h-full object-cover"></video>
                            <div class="absolute bottom-8 left-8"><p class="font-black text-lg shadow-lg">${v.title}</p></div>
                        </div>
                    </div>
                `).join('');
                lucide.createIcons();
            }
        };

        window.onload = () => { ui.renderAll(); lucide.createIcons(); };
    </script>
</body>
</html>

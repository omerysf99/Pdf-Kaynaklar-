<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Roblox Bacon Clone</title>
<style>
body { margin:0; overflow:hidden; background:#87ceeb; }
#ui{
  position:fixed;
  top:10px; left:10px;
  color:white;
  font-family:Arial;
  background:rgba(0,0,0,.6);
  padding:10px;
  border-radius:8px;
}
#cross{
  position:fixed;
  top:50%; left:50%;
  width:8px; height:8px;
  margin:-4px;
  border:2px solid white;
  border-radius:50%;
}
</style>
</head>
<body>

<div id="ui">
<b>Roblox Bacon</b><br>
WASD: Yürü<br>
Space: Zıpla<br>
Mouse: Kamera<br>
Yön sorunu düzeltildi
</div>
<div id="cross"></div>

<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>

<script>
/* ========= SAHNE ========= */
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x87ceeb);

const camera = new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

/* ========= IŞIK ========= */
scene.add(new THREE.HemisphereLight(0xffffff,0x444444,1));
const sun = new THREE.DirectionalLight(0xffffff,0.8);
sun.position.set(10,20,10);
scene.add(sun);

/* ========= MAP ========= */
function block(x,y,z,w,h,d,c){
  const m = new THREE.Mesh(
    new THREE.BoxGeometry(w,h,d),
    new THREE.MeshStandardMaterial({color:c})
  );
  m.position.set(x,y,z);
  scene.add(m);
}

block(0,-1,0,200,2,200,0x55aa55);
block(6,1,6,6,1,6,0x888888);
block(12,3,6,6,1,6,0x888888);
block(18,5,6,6,1,6,0x888888);

/* ========= BACON KARAKTER ========= */
const player = new THREE.Group();
scene.add(player);

function part(w,h,d,color,x,y,z){
  const p = new THREE.Mesh(
    new THREE.BoxGeometry(w,h,d),
    new THREE.MeshStandardMaterial({color})
  );
  p.position.set(x,y,z);
  return p;
}

/* Gövde */
const torso = part(1.6,2.2,0.8,0x2a66ff,0,2.1,0);
/* Kafa */
const head  = part(1.2,1.2,1.2,0xffd1a4,0,3.6,0);
/* Kollar */
const la = part(0.6,2,0.6,0x2a66ff,-1.2,2.1,0);
const ra = part(0.6,2,0.6,0x2a66ff, 1.2,2.1,0);
/* Bacaklar */
const ll = part(0.7,2,0.7,0x1c2f8f,-0.4,0.9,0);
const rl = part(0.7,2,0.7,0x1c2f8f, 0.4,0.9,0);

/* Bacon Saç */
const hair = new THREE.Mesh(
  new THREE.BoxGeometry(1.3,0.6,1.3),
  new THREE.MeshStandardMaterial({color:0xff7a18})
);
hair.position.set(0,4.2,0);

player.add(torso,head,la,ra,ll,rl,hair);

/* ========= KONTROLLER ========= */
let keys = {};
let velY = 0;
let canJump = false;
let yaw = 0;
let walk = 0;

document.addEventListener("keydown",e=>keys[e.code]=true);
document.addEventListener("keyup",e=>keys[e.code]=false);

document.body.addEventListener("click",()=>document.body.requestPointerLock());
document.addEventListener("mousemove",e=>{
  if(document.pointerLockElement){
    yaw -= e.movementX * 0.002;
  }
});

/* ========= OYUN DÖNGÜSÜ ========= */
function animate(){
  requestAnimationFrame(animate);

  let speed = 0.18;
  let forward = 0;
  let strafe = 0;
  let moving = false;

  if(keys.KeyW){ forward =  speed; moving=true; }
  if(keys.KeyS){ forward = -speed; moving=true; }
  if(keys.KeyA){ strafe =  speed; moving=true; }
  if(keys.KeyD){ strafe = -speed; moving=true; }

  const sin = Math.sin(yaw);
  const cos = Math.cos(yaw);

  /* DOĞRU YÖN HESABI */
  player.position.x += (forward * sin + strafe * cos);
  player.position.z += (forward * cos - strafe * sin);

  /* Karakter yönü */
  player.rotation.y = yaw;

  /* Yerçekimi */
  velY -= 0.02;
  player.position.y += velY;

  if(player.position.y <= 0){
    player.position.y = 0;
    velY = 0;
    canJump = true;
  }

  if(keys.Space && canJump){
    velY = 0.38;
    canJump = false;
  }

  /* Yürüme animasyonu */
  if(moving){
    walk += 0.15;
    la.rotation.x = Math.sin(walk) * 0.6;
    ra.rotation.x = -Math.sin(walk) * 0.6;
    ll.rotation.x = -Math.sin(walk) * 0.6;
    rl.rotation.x = Math.sin(walk) * 0.6;
  } else {
    la.rotation.x = ra.rotation.x = 0;
    ll.rotation.x = rl.rotation.x = 0;
  }

  /* Kamera */
  camera.position.set(
    player.position.x + Math.sin(yaw) * 6,
    player.position.y + 4,
    player.position.z + Math.cos(yaw) * 6
  );
  camera.lookAt(
    player.position.x,
    player.position.y + 2,
    player.position.z
  );

  renderer.render(scene,camera);
}
animate();

/* Resize */
addEventListener("resize",()=>{
  camera.aspect = innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
});
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SpyderCoin - Beast Mode</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --bg: #000; --card: #151517; --gold: #f3ba2f; --blue: #3a47ff; --neon: #00f2ff; }
        body { background: var(--bg); color: white; font-family: 'Inter', sans-serif; margin: 0; overflow: hidden; user-select: none; }

        /* Scannable Header */
        .stats-bar { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; padding: 15px; z-index: 100; position: relative; }
        .stat-item { background: var(--card); border: 1px solid #2c2c2e; padding: 8px; border-radius: 12px; text-align: center; }
        .stat-label { font-size: 9px; color: #888; text-transform: uppercase; }
        .stat-val { font-size: 13px; font-weight: 800; display: block; }

        /* Ana Bakiye */
        .main-balance { text-align: center; margin-top: 10px; z-index: 100; position: relative; }
        .coin-val { font-size: 48px; font-weight: 900; background: linear-gradient(to bottom, #fff, #888); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        /* TÄ±klama AlanÄ± */
        .tab-content { display: none; width: 100%; height: 100vh; flex-direction: column; align-items: center; padding-top: 140px; box-sizing: border-box; }
        .active { display: flex; }

        .spider-wrapper { position: relative; width: 300px; height: 300px; display: flex; justify-content: center; align-items: center; touch-action: none; }
        .spider-bg { position: absolute; width: 260px; height: 260px; background: radial-gradient(circle, var(--blue) 0%, transparent 70%); filter: blur(20px); opacity: 0.4; }
        #main-spider { font-size: 150px; z-index: 10; transition: transform 0.05s; pointer-events: none; }

        /* Mine SayfasÄ± GeliÅŸmiÅŸ */
        .mine-card { background: var(--card); width: 90%; border-radius: 20px; padding: 20px; border: 1px solid #333; text-align: center; margin-top: 20px; }
        .mine-speed { color: var(--neon); font-weight: bold; font-size: 18px; margin-bottom: 10px; }
        .timer-big { font-size: 50px; font-weight: 900; color: var(--gold); margin: 10px 0; }
        .upgrade-btn { background: #222; border: 1px solid var(--neon); color: var(--neon); padding: 8px 15px; border-radius: 10px; font-size: 12px; margin-top: 10px; }

        /* Alt Navigasyon */
        .navbar { position: fixed; bottom: 20px; width: 92%; left: 4%; background: rgba(21, 21, 23, 0.9); backdrop-filter: blur(10px); display: grid; grid-template-columns: repeat(4, 1fr); padding: 12px 0; border-radius: 20px; border: 1px solid #2c2c2e; z-index: 1000; }
        .nav-link { text-align: center; color: #555; font-size: 11px; text-decoration: none; cursor: pointer; }
        .nav-link.active { color: white; }
        .nav-link i { display: block; font-size: 20px; margin-bottom: 4px; font-style: normal; }

        /* Efektler */
        .floating-text { position: absolute; color: white; font-size: 30px; font-weight: 900; pointer-events: none; animation: fly 0.6s ease-out forwards; z-index: 2000; }
        @keyframes fly { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-100px); } }
        
        /* Enerji */
        .energy-bar { width: 90%; position: absolute; bottom: 100px; }
        .bar-outer { width: 100%; height: 12px; background: #222; border-radius: 10px; overflow: hidden; border: 1px solid #333; }
        .bar-inner { height: 100%; background: linear-gradient(90deg, #3a47ff, #00f2ff); width: 100%; transition: width 0.2s; }
    </style>
</head>
<body>

    <div class="stats-bar">
        <div class="stat-item"><span class="stat-label">TÄ±k GÃ¼cÃ¼</span><span class="stat-val" id="ui-power">+1</span></div>
        <div class="stat-item"><span class="stat-label">Mining /sn</span><span class="stat-val" id="ui-speed">1</span></div>
        <div class="stat-item"><span class="stat-label">Lig</span><span class="stat-val">Silver</span></div>
    </div>

    <div class="main-balance">
        <div class="coin-val" id="ui-balance">0</div>
    </div>

    <div id="tab-home" class="tab-content active">
        <div class="spider-wrapper" id="tap-area">
            <div class="spider-bg"></div>
            <div id="main-spider">ğŸ•·ï¸</div>
        </div>
        <div class="energy-bar">
            <div style="font-size: 12px; margin-bottom: 5px;">âš¡ <span id="ui-energy">1000</span> / <span id="ui-max-energy">1000</span></div>
            <div class="bar-outer"><div id="energy-fill" class="bar-inner"></div></div>
        </div>
    </div>

    <div id="tab-mine" class="tab-content">
        <div id="spider-army" style="position: absolute; width:100%; height:100%; pointer-events:none;"></div>
        <div class="mine-card">
            <div class="mine-speed">Ãœretim HÄ±zÄ±: <span id="ui-mine-speed">1</span> Coin/sn</div>
            <div class="timer-big" id="mine-timer">10:00</div>
            <p>Åu an biriken: <b id="mine-acc">0</b></p>
            <button class="upgrade-btn" onclick="upgradeSpeed()">HÄ±zÄ± ArtÄ±r (ğŸ’° 5000)</button>
            <br><br>
            <button id="mine-btn" style="background:var(--blue); color:white; border:none; padding:15px 30px; border-radius:15px; font-weight:bold;" onclick="handleMineAction()">MadenciliÄŸi BaÅŸlat</button>
        </div>
    </div>

    <div id="tab-friends" class="tab-content">
        <div class="mine-card">
            <h3>ArkadaÅŸlarÄ±nÄ± Getir</h3>
            <p style="font-size: 12px; color: #888;">Her arkadaÅŸÄ±n iÃ§in 5.000, Premium iÃ§in 25.000 coin!</p>
            <div style="background:#000; padding:10px; border-radius:10px; font-size:10px; color:var(--blue); margin:10px 0;" id="ui-reflink">Loading...</div>
            <button onclick="copyRef()" style="width:100%; padding:10px; border-radius:10px; background:var(--blue); color:white; border:none;">Linki Kopyala</button>
        </div>
        <div style="width:90%; margin-top:20px;">
            <b>ArkadaÅŸ Listesi (0)</b>
            <div style="margin-top:10px; color:#555; text-align:center;">HenÃ¼z kimse yok.</div>
        </div>
    </div>

    <nav class="navbar">
        <div class="nav-link active" onclick="switchTab('home', this)"><i>ğŸ </i>Home</div>
        <div class="nav-link" onclick="switchTab('mine', this)"><i>â›ï¸</i>Mine</div>
        <div class="nav-link" onclick="switchTab('friends', this)"><i>ğŸ‘¥</i>Friends</div>
        <div class="nav-link"><i>ğŸš€</i>Boost</div>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // STATE
        let bakiye = 0, enerji = 1000, maxEnerji = 1000, guc = 1;
        let mineHizi = 1, mineSuresi = 600, biriken = 0, miningAktif = false, mineInterval;

        const user = tg.initDataUnsafe.user;
        const refLink = `https://t.me/SpyderCoinBot?start=${user ? user.id : '8392479231'}`;
        document.getElementById('ui-reflink').innerText = refLink;

        // UI REFRESH
        function refresh() {
            document.getElementById('ui-balance').innerText = Math.floor(bakiye).toLocaleString();
            document.getElementById('ui-energy').innerText = enerji;
            document.getElementById('ui-max-energy').innerText = maxEnerji;
            document.getElementById('energy-fill').style.width = (enerji/maxEnerji*100) + "%";
            document.getElementById('ui-power').innerText = "+" + guc;
            document.getElementById('ui-speed').innerText = mineHizi;
            document.getElementById('ui-mine-speed').innerText = mineHizi;
        }

        // TIKLAMA
        document.getElementById('tap-area').addEventListener('touchstart', (e) => {
            e.preventDefault();
            for(let i=0; i<e.changedTouches.length; i++) {
                if(enerji >= guc) {
                    bakiye += guc; enerji -= guc;
                    showFloat(e.changedTouches[i].clientX, e.changedTouches[i].clientY);
                }
            }
            refresh();
            if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
        });

        function showFloat(x, y) {
            const f = document.createElement('div');
            f.className = 'floating-text'; f.innerText = "+" + guc;
            f.style.left = x + 'px'; f.style.top = y + 'px';
            document.body.appendChild(f);
            document.getElementById('main-spider').style.transform = "scale(0.9)";
            setTimeout(() => { f.remove(); document.getElementById('main-spider').style.transform = "scale(1)"; }, 600);
        }

        // SEKMELER
        function switchTab(id, el) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.getElementById('tab-' + id).classList.add('active');
            el.classList.add('active');
        }

        // MINING ENGINE
        function handleMineAction() {
            if(miningAktif) return;
            startMining();
        }

        function startMining() {
            miningAktif = true; biriken = 0; mineSuresi = 600;
            document.getElementById('mine-btn').style.opacity = '0.5';
            document.getElementById('mine-btn').innerText = "Madencilik YapÄ±lÄ±yor...";
            
            mineInterval = setInterval(() => {
                mineSuresi--;
                biriken += mineHizi;
                updateMineUI();
                if(mineSuresi <= 0) stopMining();
            }, 1000);
        }

        function updateMineUI() {
            let m = Math.floor(mineSuresi/60), s = mineSuresi%60;
            document.getElementById('mine-timer').innerText = `${m}:${s<10?'0'+s:s}`;
            document.getElementById('mine-acc').innerText = biriken;
        }

        function stopMining() {
            clearInterval(mineInterval);
            miningAktif = false;
            const btn = document.getElementById('mine-btn');
            btn.style.opacity = '1';
            btn.innerText = "Ã–dÃ¼lÃ¼ Topla (" + biriken + ")";
            btn.onclick = () => {
                bakiye += biriken; biriken = 0;
                btn.innerText = "MadenciliÄŸi BaÅŸlat";
                btn.onclick = handleMineAction;
                document.getElementById('mine-timer').innerText = "10:00";
                refresh();
            };
        }

        function upgradeSpeed() {
            if(bakiye >= 5000) {
                bakiye -= 5000; mineHizi++; refresh();
                tg.showPopup({message: "Mining hÄ±zÄ± artÄ±rÄ±ldÄ±! Yeni hÄ±z: " + mineHizi});
            } else {
                tg.showPopup({message: "Yetersiz bakiye!"});
            }
        }

        function copyRef() {
            navigator.clipboard.writeText(refLink);
            tg.showPopup({message: "Link kopyalandÄ±!"});
        }

        // Enerji Regen
        setInterval(() => { if(enerji < maxEnerji) { enerji++; refresh(); } }, 1500);

        refresh();
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Spyder - Cyber Mining</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://adexora.com/cdn/ads.js?id=1545"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #00a3ff;
            --bg: #050a12;
            --card: #111b2b;
            --spyder: #ff4444;
            --text-dim: #8e99a8;
            --gold: #facc15;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; user-select: none; }
        body { background-color: var(--bg); color: white; font-family: 'Inter', sans-serif; height: 100vh; overflow: hidden; display: flex; flex-direction: column; }

        header { padding: 15px; display: flex; flex-direction: column; gap: 8px; }
        .bal-card { background: var(--card); padding: 10px 15px; border-radius: 15px; display: flex; align-items: center; justify-content: space-between; border: 1px solid rgba(255,255,255,0.05); }
        .bal-info { display: flex; align-items: center; gap: 10px; }
        .coin-icon { width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: #0088cc; font-size: 14px; }
        .bal-num { font-family: 'Orbitron'; font-size: 13px; font-weight: 700; }
        .wd-btn { background: var(--primary); color: white; border: none; padding: 5px 10px; border-radius: 8px; font-family: 'Orbitron'; font-size: 9px; cursor: pointer; }

        main { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; }
        
        /* TIKLAMA VE PAR√áACIK EFEKTƒ∞ */
        .main-logo-orb { width: 190px; height: 190px; background: radial-gradient(circle, #1a2a44 0%, #070d16 100%); border: 5px solid var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 40px rgba(0,163,255,0.3); cursor: pointer; position: relative; z-index: 10; transition: transform 0.1s; }
        .main-logo-orb:active { transform: scale(0.95); }
        
        .particle { position: absolute; width: 20px; height: 20px; pointer-events: none; z-index: 100; animation: particle-fly 0.8s ease-out forwards; }
        @keyframes particle-fly {
            0% { transform: translate(0,0) scale(1) rotate(0deg); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) scale(0.5) rotate(180deg); opacity: 0; }
        }

        .pool-text { font-family: 'Orbitron'; font-size: 38px; font-weight: 900; margin-top: 20px; color: white; }
        .speed-badge { background: rgba(0,163,255,0.1); border: 1px solid var(--primary); padding: 4px 12px; border-radius: 20px; color: var(--primary); font-size: 11px; margin-top: 5px; font-weight: 700; }

        /* ACTIONS */
        .actions-container { width: 100%; max-width: 350px; display: flex; flex-direction: column; gap: 10px; margin-top: 30px; padding: 0 20px; margin-bottom: 80px; }
        .btn-act { height: 48px; border-radius: 12px; border: none; font-family: 'Orbitron'; font-weight: 700; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 13px; }
        .btn-claim { background: var(--primary); color: white; flex: 1; }
        .btn-boost { background: transparent; border: 2px solid var(--primary); color: var(--primary); flex: 1; }
        .btn-bonus { background: linear-gradient(90deg, #111b2b 0%, #1a2a44 100%); border: 1px solid var(--gold); color: var(--gold); width: 100%; }

        /* NAVBAR (SEKMELER) */
        nav { position: fixed; bottom: 0; width: 100%; height: 70px; background: #0c1626; display: flex; justify-content: space-around; align-items: center; border-top: 1px solid rgba(255,255,255,0.05); padding-bottom: 10px; }
        .nav-item { display: flex; flex-direction: column; align-items: center; gap: 4px; color: var(--text-dim); font-size: 10px; opacity: 0.6; cursor: pointer; }
        .nav-item.active { color: var(--primary); opacity: 1; }
        .nav-item i { font-size: 20px; font-style: normal; }

        /* MODAL */
        .modal { position: fixed; inset: 0; background: rgba(5, 10, 18, 0.98); display: none; align-items: center; justify-content: center; z-index: 1000; padding: 20px; }
        .modal-cont { background: #0c1626; width: 100%; max-width: 380px; padding: 25px; border-radius: 20px; border: 1px solid var(--primary); }
        .m-title { font-family: 'Orbitron'; color: var(--primary); text-align: center; margin-bottom: 20px; font-size: 18px; }
        .m-input { width: 100%; padding: 12px; background: #070d16; border: 1px solid rgba(255,255,255,0.1); border-radius: 10px; color: white; margin-bottom: 15px; outline: none; }
        .m-info-box { background: rgba(0, 163, 255, 0.05); padding: 12px; border-radius: 10px; font-size: 11px; margin-bottom: 15px; border: 1px dashed var(--primary); color: var(--text-dim); }
        .req-highlight { color: var(--gold); font-weight: bold; }

        #loading { position: fixed; inset: 0; background: #050a12; z-index: 9999; display: flex; align-items: center; justify-content: center; flex-direction: column; }
    </style>
</head>
<body onload="initApp()">

    <div id="loading">
        <h2 style="font-family:'Orbitron'; color:var(--primary);">SPYDER CORE</h2>
        <p style="font-size: 12px; color: var(--text-dim); margin-top: 10px;">Veriler Senkronize Ediliyor...</p>
    </div>

    <header>
        <div class="bal-card">
            <div class="bal-info">
                <div class="coin-icon"><img src="https://cryptologos.cc/logos/toncoin-ton-logo.png" width="18"></div>
                <div class="bal-num" id="ton-h">0.00000</div>
            </div>
            <button class="wd-btn" onclick="openM('withdraw')">WITHDRAW</button>
        </div>
        <div class="bal-card" style="border-color: var(--spyder);">
            <div class="bal-info">
                <div class="coin-icon" style="background: var(--spyder);">üï∑Ô∏è</div>
                <div class="bal-num" id="spyder-h" style="color: var(--spyder);">0.00</div>
            </div>
            <button class="wd-btn" style="background: #333; opacity: 0.5; cursor: default;" onclick="TG.showAlert('Spyder √ßekimleri yakƒ±nda ba≈ülayacak!')">LOCKED</button>
        </div>
    </header>

    <main>
        <div class="main-logo-orb" id="target" onclick="clickAction(event)">
            <img src="https://cryptologos.cc/logos/toncoin-ton-logo.png" width="85">
        </div>
        
        <div class="pool-text" id="pool-v">0.000000</div>
        <div class="speed-badge"><span id="speed-v">100.00</span> GH/s ‚ö°</div>

        <div class="actions-container">
            <div style="display:flex; gap:10px;">
                <button class="btn-act btn-claim" onclick="claim()">CLAIM</button>
                <button class="btn-act btn-boost" onclick="openM('boost')">BOOST</button>
            </div>
            <button class="btn-act btn-bonus" onclick="watchBonusAd()">üéÅ G√úNL√úK BONUS (+0.0001 TON)</button>
        </div>
    </main>

    <nav>
        <div class="nav-item"><i>üíº</i><span>Wallet</span></div>
        <div class="nav-item"><i>üë•</i><span>Friends</span></div>
        <div class="nav-item active"><i>üåÄ</i><span>Home</span></div>
        <div class="nav-item"><i>üéØ</i><span>Tasks</span></div>
        <div class="nav-item"><i>‚öôÔ∏è</i><span>Settings</span></div>
    </nav>

    <div class="modal" id="m-withdraw">
        <div class="modal-cont">
            <h2 class="m-title">TON WITHDRAW</h2>
            <label style="font-size: 11px; color: var(--text-dim);">√áEKƒ∞LECEK Mƒ∞KTAR</label>
            <input type="number" id="wd-amt" class="m-input" value="0.10" step="0.01" oninput="calculateAds()">
            
            <div class="m-info-box">
                Gereken Toplam Reklam: <span class="req-highlight" id="req-ads">150</span><br>
                Sizin ƒ∞zlediƒüiniz: <span class="req-highlight" id="user-ads">0</span>
            </div>

            <label style="font-size: 11px; color: var(--text-dim);">TON C√úZDAN ADRESƒ∞</label>
            <input type="text" id="wd-wallet" class="m-input" style="background:#e6efff; color:#000;" placeholder="UQ...">
            
            <button class="btn-act btn-claim" style="width:100%; background:#0088cc;" onclick="processWD()">TALEBƒ∞ G√ñNDER</button>
            <button onclick="closeM()" style="background:none; border:none; color:var(--spyder); width:100%; margin-top:15px; cursor:pointer;">ƒ∞ptal Et</button>
        </div>
    </div>

    <div class="modal" id="m-boost">
        <div class="modal-cont">
            <h2 class="m-title">BOOST SPEED</h2>
            <button class="btn-act btn-claim" style="width:100%;" onclick="watchAd()">REKLAM ƒ∞ZLE (+1 GH/s)</button>
            <button onclick="closeM()" style="background:none; border:none; color:var(--spyder); width:100%; margin-top:15px; cursor:pointer;">KAPAT</button>
        </div>
    </div>

    <script>
        // --- FIREBASE AYARLARI ---
        const firebaseConfig = {
            apiKey: "API_KEY_BURAYA",
            authDomain: "PROJE_ID.firebaseapp.com",
            databaseURL: "https://PROJE_ID-default-rtdb.firebaseio.com",
            projectId: "PROJE_ID",
            storageBucket: "PROJE_ID.appspot.com",
            messagingSenderId: "SENDER_ID",
            appId: "APP_ID"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const TG = window.Telegram.WebApp;

        let userID = "guest_" + Math.floor(Math.random() * 9999);
        let data = { ton: 0, pool: 0, speed: 100.0, ads: 0, spyder: 0, lastUpdate: Date.now() };

        async function initApp() {
            if (TG.initDataUnsafe && TG.initDataUnsafe.user) userID = TG.initDataUnsafe.user.id;
            
            // Firebase √ßekme
            db.ref('users/' + userID).once('value').then((snap) => {
                const cloud = snap.val();
                if (cloud) {
                    const passed = Math.floor((Date.now() - cloud.lastUpdate) / 1000);
                    const gain = passed * (cloud.speed * 0.0000001);
                    data = {...cloud, pool: cloud.pool + gain, lastUpdate: Date.now()};
                }
                document.getElementById('loading').style.display = 'none';
                startLoop();
            }).catch(() => {
                document.getElementById('loading').style.display = 'none';
                startLoop();
            });
        }

        function startLoop() {
            setInterval(() => {
                data.pool += (data.speed * 0.0000001);
                data.spyder += 0.01; // Spyder coin yava≈ü√ßa birikir
                data.lastUpdate = Date.now();
                updateUI();
                if (Math.floor(Date.now() / 1000) % 10 === 0) save();
            }, 1000);
        }

        function updateUI() {
            document.getElementById('pool-v').innerText = data.pool.toFixed(6);
            document.getElementById('ton-h').innerText = data.ton.toFixed(5);
            document.getElementById('spyder-h').innerText = data.spyder.toFixed(2);
            document.getElementById('speed-v').innerText = data.speed.toFixed(2);
            document.getElementById('user-ads').innerText = data.ads;
        }

        // --- TIKLAMA VE PAR√áACIK MANTIƒûI ---
        function clickAction(e) {
            data.pool += 0.0000001;
            TG.HapticFeedback.impactOccurred('light');
            
            const target = document.getElementById('target');
            for(let i=0; i<5; i++) {
                const p = document.createElement('img');
                p.src = "https://cryptologos.cc/logos/toncoin-ton-logo.png";
                p.className = "particle";
                
                // Rastgele y√∂nler
                const tx = (Math.random() - 0.5) * 250;
                const ty = -100 - (Math.random() * 150);
                
                p.style.setProperty('--tx', `${tx}px`);
                p.style.setProperty('--ty', `${ty}px`);
                p.style.left = "50%";
                p.style.top = "50%";
                
                target.appendChild(p);
                setTimeout(() => p.remove(), 800);
            }
        }

        // --- OTOMATƒ∞K REKLAM HESABI ---
        function calculateAds() {
            const amt = parseFloat(document.getElementById('wd-amt').value) || 0;
            // Kural: Her 0.01 TON √ßekimi i√ßin 15 reklam
            const required = Math.ceil((amt / 0.01) * 15);
            document.getElementById('req-ads').innerText = required;
        }

        function save() { db.ref('users/' + userID).set(data); }
        function openM(id) { document.getElementById('m-' + id).style.display = 'flex'; if(id==='withdraw') calculateAds(); }
        function closeM() { document.querySelectorAll('.modal').forEach(m => m.style.display = 'none'); }

        function claim() {
            if(data.pool <= 0) return;
            data.ton += data.pool; data.pool = 0; save();
            TG.HapticFeedback.notificationOccurred('success');
        }

        function watchAd() {
            window.showAdexora().then(() => { data.ads++; data.speed += 1; save(); closeM(); });
        }

        function watchBonusAd() {
            window.showAdexora().then(() => { data.ads++; data.ton += 0.0001; save(); });
        }

        function processWD() {
            const amt = parseFloat(document.getElementById('wd-amt').value);
            const req = Math.ceil((amt / 0.01) * 15);
            if(data.ton >= amt && data.ads >= req && amt >= 0.1) {
                data.ton -= amt; save(); TG.showAlert("√áekim talebi alƒ±ndƒ±!"); closeM();
            } else {
                TG.showAlert(`Yetersiz bakiye veya reklam! Gereken Reklam: ${req}`);
            }
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CW Flappy - Full Feature</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800;900&display=swap');
        body { background-color: #4eb5d3; font-family: 'Inter', sans-serif; margin: 0; overflow: hidden; user-select: none; }
        
        /* Sayfa YÃ¶netimi */
        .page { display: none; height: calc(100vh - 75px); position: relative; overflow-y: auto; }
        .page.active { display: block; }

        /* Arka Plan BileÅŸenleri */
        .ground { 
            position: absolute; bottom: 75px; width: 100%; height: 35px; 
            background: repeating-linear-gradient(45deg, #8bc34a, #8bc34a 15px, #9ccc65 15px, #9ccc65 30px);
            border-top: 4px solid #558b2f; z-index: 5;
        }

        /* Bilet TasarÄ±mÄ± */
        .ticket-ui { 
            background: #ffc107; clip-path: polygon(10% 0, 90% 0, 100% 20%, 100% 80%, 90% 100%, 10% 100%, 0 80%, 0 20%);
        }

        /* Oyun GÃ¶rseli */
        #game-canvas { display: none; position: absolute; inset: 0; z-index: 100; }
        .score-display { position: absolute; top: 60px; width: 100%; text-align: center; font-size: 70px; color: white; font-weight: 900; z-index: 110; text-shadow: 4px 4px 0 #000; }
        
        /* Modal */
        #modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.8);
            display: none; justify-content: center; align-items: center; z-index: 2000; backdrop-filter: blur(5px);
        }
    </style>
</head>
<body>

<div id="modal-overlay">
    <div class="bg-white rounded-[40px] p-8 text-center w-[85%] shadow-2xl animate__animated animate__zoomIn">
        <h2 class="text-gray-400 font-bold uppercase text-[10px] mb-1">SON SKOR</h2>
        <h1 id="modal-score" class="text-6xl font-black text-blue-600 mb-6">0</h1>
        <div class="grid grid-cols-2 gap-3 mb-6">
            <div class="bg-gray-50 p-3 rounded-2xl">
                <p class="text-[9px] text-gray-400 font-bold">BUGÃœN</p>
                <p id="modal-today" class="font-black">0</p>
            </div>
            <div class="bg-gray-50 p-3 rounded-2xl">
                <p class="text-[9px] text-gray-400 font-bold">REKOR</p>
                <p id="modal-record" class="font-black">0</p>
            </div>
        </div>
        <button onclick="closeModal()" class="w-full bg-blue-600 text-white py-4 rounded-2xl font-black shadow-lg">TAMAM</button>
    </div>
</div>

<div class="max-w-md mx-auto h-screen flex flex-col bg-[#4eb5d3] overflow-hidden">
    
    <div class="flex items-center justify-between p-3 z-50">
        <div class="flex items-center gap-2">
            <div class="w-10 h-8 bg-[#9c5c3c] rounded border-2 border-black flex items-center justify-center text-white font-black text-[10px]">CW</div>
            <span class="text-white font-black text-xl italic italic">Flappy</span>
        </div>
        <div class="flex items-center gap-2">
            <div class="text-[9px] font-bold text-white bg-black/20 px-3 py-1.5 rounded-full border border-white/20">Admin ID: 8392479231</div>
            <div class="bg-blue-500 text-white text-[10px] font-black px-2 py-1 rounded">EN</div>
        </div>
    </div>

    <div id="game-container" style="display:none;">
        <div class="score-display" id="current-score-ui">0</div>
        <canvas id="game-canvas"></canvas>
    </div>

    <div id="flappy-page" class="page active px-3">
        <div class="grid grid-cols-2 gap-2 mt-2">
            <div class="bg-white rounded-3xl p-4 shadow-md">
                <div class="flex items-center gap-1 text-[10px] font-bold text-gray-400 uppercase mb-3">
                    <span class="text-red-500 text-lg">â¤ï¸</span> Attempts today <span class="text-blue-600 ml-auto" id="heart-count">14</span>
                </div>
                <button class="w-full bg-blue-500 text-white py-2 rounded-xl font-black text-xs shadow-[0_4px_0_#1d4ed8]">Increase</button>
            </div>
            <div class="bg-white rounded-3xl p-4 shadow-md text-[10px] font-bold space-y-1.5 uppercase">
                <div class="flex justify-between"><span>ğŸ† Record today</span> <span class="text-blue-500" id="ui-today">0.00</span></div>
                <div class="flex justify-between"><span>ğŸ† All-time record</span> <span class="text-blue-600" id="ui-record">0.00</span></div>
                <div class="flex justify-between"><span>ğŸš€ Point multiplier</span> <span class="text-green-500">x1.0</span></div>
            </div>
        </div>

        <div class="mt-4 flex gap-2">
            <div class="ticket-ui flex-1 h-14 flex items-center justify-center font-black text-white text-[10px]">CW PASS</div>
            <div class="flex-[2] bg-blue-600/80 border-2 border-dashed border-white/40 p-2 rounded-2xl text-white text-[9px] font-bold flex items-center justify-between">
                <span>ğŸ Free daily lottery</span> <span class="bg-white/20 p-1 rounded-full text-[10px]">ğŸ”Š</span>
            </div>
        </div>

        <div class="flex flex-col items-center justify-center mt-24">
            <div class="w-12 h-9 bg-[#9c5c3c] border-2 border-black rounded flex items-center justify-center text-white font-bold text-[10px] animate-bounce">CW</div>
            <button id="start-btn" class="mt-16 bg-white p-7 rounded-[35px] shadow-2xl border-4 border-gray-100 active:scale-90 transition-transform">
                <div class="w-0 h-0 border-t-[15px] border-t-transparent border-l-[25px] border-l-green-600 border-b-[15px] border-b-transparent ml-1"></div>
            </button>
        </div>
    </div>

    <div id="rating-page" class="page px-5 pt-5">
        <h2 class="text-white font-black text-2xl mb-4 italic text-center">Liderlik Tablosu ğŸ†</h2>
        <div class="bg-white/10 rounded-3xl p-2 border border-white/20">
            <div class="bg-white rounded-2xl p-4 flex justify-between items-center mb-2">
                <span class="font-bold text-gray-700">1. Admin (Sen)</span>
                <span id="rank-score" class="font-black text-blue-600">0.00</span>
            </div>
            <div class="p-4 text-white/50 text-center text-xs">DiÄŸer oyuncular yÃ¼kleniyor...</div>
        </div>
    </div>

    <div id="friends-page" class="page px-5 pt-10 text-center">
        <div class="text-6xl mb-6">ğŸ¤</div>
        <h2 class="text-white font-black text-2xl mb-2">ArkadaÅŸlarÄ±nÄ± Davet Et</h2>
        <p class="text-white/70 text-sm mb-10">Her arkadaÅŸÄ±n iÃ§in 5 ek hak ve x0.1 multiplier kazanÄ±rsÄ±n!</p>
        <button class="w-full bg-white text-blue-600 py-4 rounded-2xl font-black shadow-xl">DAVET LÄ°NKÄ°NÄ° KOPYALA</button>
    </div>

    <div id="wallet-page" class="page px-5 pt-5">
        <div class="bg-white rounded-[40px] p-8 text-center shadow-2xl">
            <div class="text-5xl mb-4">ğŸ’°</div>
            <p class="text-gray-400 font-bold text-[10px] uppercase mb-1">CÃ¼zdan Bakiyesi</p>
            <h1 class="text-4xl font-black text-gray-800 mb-8">0.00 CWL</h1>
            <button onclick="connectWallet()" id="wallet-btn" class="w-full bg-[#0088cc] text-white py-4 rounded-2xl font-bold flex items-center justify-center gap-2">
                TON CONNECT
            </button>
        </div>
    </div>

    <div id="tasks-page" class="page px-5 pt-5">
        <h2 class="text-white font-black text-2xl mb-5">GÃ¶revler âœ…</h2>
        <div class="space-y-3">
            <div class="bg-white/10 p-4 rounded-2xl border border-white/10 flex justify-between items-center">
                <div><p class="text-white font-bold">Twitter Takip</p><p class="text-[10px] text-blue-200">+3 Kalp</p></div>
                <button class="bg-blue-500 text-white px-4 py-2 rounded-xl text-xs font-bold">YAP</button>
            </div>
            <div class="bg-white/10 p-4 rounded-2xl border border-white/10 flex justify-between items-center">
                <div><p class="text-white font-bold">GÃ¼nlÃ¼k GiriÅŸ</p><p class="text-[10px] text-blue-200">+1 Kalp</p></div>
                <button class="bg-green-500 text-white px-4 py-2 rounded-xl text-xs font-bold">ALINDI</button>
            </div>
        </div>
    </div>

    <div class="ground"></div>

    <div class="h-[75px] bg-white border-t border-gray-100 flex justify-around items-center z-[1000] relative">
        <button onclick="showTab('flappy', this)" class="tab-btn active flex flex-col items-center gap-1 text-blue-500">
            <span class="text-2xl">ğŸ®</span><span class="text-[9px] font-black uppercase">Flappy</span>
        </button>
        <button onclick="showTab('rating', this)" class="tab-btn flex flex-col items-center gap-1 text-gray-400">
            <span class="text-2xl">ğŸ†</span><span class="text-[9px] font-black uppercase">Rating</span>
        </button>
        <button onclick="showTab('friends', this)" class="tab-btn flex flex-col items-center gap-1 text-gray-400">
            <span class="text-2xl">ğŸ‘¥</span><span class="text-[9px] font-black uppercase">Friends</span>
        </button>
        <button onclick="showTab('wallet', this)" class="tab-btn flex flex-col items-center gap-1 text-gray-400">
            <span class="text-2xl">ğŸ’³</span><span class="text-[9px] font-black uppercase">Wallet</span>
        </button>
        <button onclick="showTab('tasks', this)" class="tab-btn flex flex-col items-center gap-1 text-gray-400">
            <span class="text-2xl">âœ…</span><span class="text-[9px] font-black uppercase">Tasks</span>
        </button>
    </div>
</div>

<script>
    let hearts = 14;
    let dailyBest = 0;
    let allTimeBest = 0;
    let currentScore = 0;
    let isPlaying = false;
    let pipes = [];
    let animationRef;

    // --- SEKME SÄ°STEMÄ° ---
    function showTab(tabId, btn) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(tabId + '-page').classList.add('active');
        
        document.querySelectorAll('.tab-btn').forEach(b => {
            b.classList.remove('text-blue-500');
            b.classList.add('text-gray-400');
        });
        btn.classList.add('text-blue-500');
        btn.classList.remove('text-gray-400');
        
        // EÄŸer oyun aÃ§Ä±ksa kapat
        stopGameEngine();
    }

    // --- WALLET ---
    function connectWallet() {
        const addr = prompt("TON Wallet Adresinizi Girin:");
        if(addr) {
            document.getElementById('wallet-btn').innerText = addr.substring(0,8) + "...";
            alert("CÃ¼zdan baÅŸarÄ±yla baÄŸlandÄ±!");
        }
    }

    // --- OYUN MOTORU ---
    const canvas = document.getElementById('game-canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth > 450 ? 450 : window.innerWidth;
    canvas.height = window.innerHeight - 75;

    const bird = { x: 60, y: 300, w: 34, h: 26, v: 0, g: 0.25, j: 5 };

    function loop() {
        if(!isPlaying) return;
        ctx.fillStyle = "#70c5ce";
        ctx.fillRect(0,0, canvas.width, canvas.height);

        bird.v += bird.g;
        bird.y += bird.v;

        // Karakter
        ctx.fillStyle = "#9c5c3c";
        ctx.fillRect(bird.x, bird.y, bird.w, bird.h);
        ctx.strokeRect(bird.x, bird.y, bird.w, bird.h);

        // Borular
        if(pipes.length === 0 || pipes[pipes.length-1].x < canvas.width - 200) {
            pipes.push({ x: canvas.width, y: Math.random() * (canvas.height - 300) + 100, gap: 160, scored: false });
        }

        pipes.forEach(p => {
            p.x -= 3.5;
            ctx.fillStyle = "#2ecc71";
            ctx.fillRect(p.x, 0, 60, p.y);
            ctx.fillRect(p.x, p.y + p.gap, 60, canvas.height);

            if(bird.x + bird.w > p.x && bird.x < p.x + 60 && (bird.y < p.y || bird.y + bird.h > p.y + p.gap)) gameOver();
            if(!p.scored && p.x < bird.x) {
                p.scored = true;
                currentScore++;
                document.getElementById('current-score-ui').innerText = currentScore;
            }
        });

        if(bird.y + bird.h > canvas.height || bird.y < 0) gameOver();
        pipes = pipes.filter(p => p.x > -100);
        animationRef = requestAnimationFrame(loop);
    }

    function gameOver() {
        isPlaying = false;
        cancelAnimationFrame(animationRef);
        hearts--;
        
        if(currentScore > dailyBest) dailyBest = currentScore;
        if(currentScore > allTimeBest) allTimeBest = currentScore;

        updateUI();
        
        document.getElementById('modal-score').innerText = currentScore;
        document.getElementById('modal-today').innerText = dailyBest;
        document.getElementById('modal-record').innerText = allTimeBest;
        document.getElementById('modal-overlay').style.display = 'flex';
    }

    function updateUI() {
        document.getElementById('heart-count').innerText = hearts;
        document.getElementById('ui-today').innerText = dailyBest + ".00";
        document.getElementById('ui-record').innerText = allTimeBest + ".00";
        document.getElementById('rank-score').innerText = allTimeBest + ".00";
    }

    function stopGameEngine() {
        isPlaying = false;
        document.getElementById('game-container').style.display = 'none';
        cancelAnimationFrame(animationRef);
    }

    function closeModal() {
        document.getElementById('modal-overlay').style.display = 'none';
        document.getElementById('game-container').style.display = 'none';
    }

    document.getElementById('start-btn').addEventListener('click', () => {
        if(hearts <= 0) return alert("HakkÄ±nÄ±z bitti!");
        isPlaying = true;
        currentScore = 0;
        pipes = [];
        bird.y = 300;
        bird.v = 0;
        document.getElementById('current-score-ui').innerText = "0";
        document.getElementById('game-container').style.display = 'block';
        document.getElementById('game-canvas').style.display = 'block';
        loop();
    });

    window.addEventListener('touchstart', (e) => {
        if(isPlaying) {
            e.preventDefault();
            bird.v = -bird.j;
        }
    });
</script>
</body>
</html>

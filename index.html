<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CW Flappy Ultimate</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap');
        body { background-color: #4eb5d3; font-family: 'Inter', sans-serif; margin: 0; overflow: hidden; user-select: none; }
        
        .page { display: none; height: calc(100vh - 75px); position: relative; overflow-y: auto; z-index: 10; }
        .page.active { display: block; }
        
        /* CSS Saf Arka Plan */
        .city-layer { position: absolute; bottom: 110px; width: 100%; height: 80px; background: linear-gradient(transparent, #81d4fa); opacity: 0.5; z-index: 1; }
        .ground-animated { 
            position: absolute; bottom: 75px; width: 200%; height: 35px; 
            background: repeating-linear-gradient(45deg, #8bc34a, #8bc34a 15px, #9ccc65 15px, #9ccc65 30px);
            border-top: 4px solid #558b2f; z-index: 5; animation: scrollGround 1s linear infinite;
        }
        @keyframes scrollGround { from { transform: translateX(0); } to { transform: translateX(-30px); } }

        /* Bilet ve Karakter */
        .ticket-shape { background: #ffc107; clip-path: polygon(8% 0, 92% 0, 100% 20%, 100% 80%, 92% 100%, 8% 100%, 0 80%, 0 20%); }
        .bird-body { width: 50px; height: 36px; background: #9c5c3c; border: 3px solid #000; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: 900; font-size: 12px; box-shadow: inset -4px -4px 0 rgba(0,0,0,0.2); }
        
        #game-canvas { display: none; position: absolute; inset: 0; z-index: 100; cursor: pointer; }
        .score-hud { position: absolute; top: 40px; width: 100%; text-align: center; font-size: 60px; color: white; font-weight: 900; text-shadow: 4px 4px 0 #000; z-index: 110; pointer-events: none; }
    </style>
</head>
<body class="flex justify-center items-center h-screen">

<div class="w-full max-w-md h-full flex flex-col relative bg-[#4eb5d3] shadow-2xl overflow-hidden border-x border-white/20">
    
    <div class="flex items-center justify-between p-3 z-50">
        <div class="flex items-center gap-2">
            <div class="w-9 h-7 bg-[#9c5c3c] rounded border-2 border-black flex items-center justify-center text-[9px] text-white font-black">CW</div>
            <span class="text-white font-black text-lg tracking-tighter italic">Flappy</span>
        </div>
        <div class="flex items-center gap-2">
            <div class="bg-blue-600 text-white text-[9px] font-bold px-2 py-0.5 rounded-full">CW</div>
            <div class="text-[9px] font-bold text-white bg-black/20 px-2 py-1 rounded-full border border-white/20">âœ¿EARNâœ¿MONEY...</div>
            <div class="bg-blue-500 text-white text-[9px] font-black px-2 py-1 rounded shadow-sm">EN</div>
        </div>
    </div>

    <div id="game-ui" style="display:none;">
        <div class="score-hud" id="live-score">0</div>
        <canvas id="game-canvas"></canvas>
    </div>

    <div id="flappy-page" class="page active px-3">
        <div class="grid grid-cols-2 gap-2 mt-2">
            <div class="bg-white rounded-2xl p-3 shadow-lg">
                <div class="flex items-center gap-1 text-[10px] font-bold text-gray-400 uppercase mb-2">
                    <span class="text-red-500 text-sm">â¤ï¸</span> Attempts today <span class="text-blue-600 ml-auto" id="heart-val">10</span>
                </div>
                <button onclick="changePage('tasks')" class="w-full bg-blue-500 text-white py-2 rounded-xl font-black text-xs shadow-[0_4px_0_#1d4ed8] active:translate-y-1 transition-all uppercase">Increase</button>
            </div>
            <div class="bg-white rounded-2xl p-3 shadow-lg text-[9px] font-bold space-y-1.5 uppercase">
                <div class="flex justify-between"><span>ğŸ† Record today</span> <span class="text-blue-500" id="daily-ui">0.00</span></div>
                <div class="flex justify-between"><span>ğŸ† All-time record</span> <span class="text-blue-500" id="record-ui">0.00</span></div>
                <div class="flex justify-between"><span>ğŸš€ Multiplier</span> <span class="text-green-500">x1.00</span></div>
            </div>
        </div>

        <div class="mt-4 flex gap-2">
            <div class="ticket-shape flex-1 h-14 flex items-center justify-center font-black text-white text-[10px] shadow-lg">CW PASS</div>
            <div class="flex-[2] bg-blue-600/80 border-2 border-dashed border-white/30 p-2 rounded-2xl text-white text-[9px] font-bold flex items-center justify-between">
                <span>ğŸ FREE DAILY LOTTERY</span> <span class="bg-white/20 p-1.5 rounded-full">ğŸ”Š</span>
            </div>
        </div>

        <div class="flex flex-col items-center justify-center mt-20">
            <div class="bird-body animate-bounce">CW</div>
            <button id="play-btn" class="mt-14 bg-white p-6 rounded-[35px] border-4 border-gray-200 shadow-2xl hover:scale-105 active:scale-90 transition-all">
                <div class="w-0 h-0 border-t-[15px] border-t-transparent border-l-[25px] border-l-green-600 border-b-[15px] border-b-transparent ml-1"></div>
            </button>
        </div>
    </div>

    <div id="rating-page" class="page px-5 pt-4">
        <h2 class="text-white font-black text-2xl mb-4 italic">Leaderboard ğŸ†</h2>
        <div class="space-y-2">
            <div class="bg-white/90 p-4 rounded-2xl flex justify-between items-center border-l-4 border-yellow-400">
                <span class="font-bold text-sm">1. @LegendaryBird</span> <span class="font-black text-blue-600">842.00</span>
            </div>
            <div class="bg-white/20 p-4 rounded-2xl flex justify-between items-center text-white italic">
                <span>Senin SÄ±ran: #12,492</span> <span>0.00</span>
            </div>
        </div>
    </div>

    <div id="friends-page" class="page px-5 pt-4 text-center">
        <div class="text-5xl mb-4">ğŸ‘¥</div>
        <h2 class="text-white font-black text-xl mb-2">ArkadaÅŸlarÄ±nÄ± Ã‡aÄŸÄ±r!</h2>
        <p class="text-white/70 text-sm mb-6">Her davet ettiÄŸin arkadaÅŸÄ±n iÃ§in +3 â¤ï¸ hak kazanÄ±rsÄ±n.</p>
        <button class="bg-white text-blue-500 w-full py-4 rounded-2xl font-black shadow-xl">DAVET LÄ°NKÄ°NÄ° KOPYALA</button>
    </div>

    <div id="wallet-page" class="page px-5 pt-4">
        <div class="bg-white rounded-[35px] p-8 shadow-2xl text-center">
            <div class="text-4xl mb-3">ğŸ’</div>
            <p class="text-gray-400 font-bold text-xs uppercase tracking-widest mb-1">Total Balance</p>
            <h1 class="text-4xl font-black text-gray-800 mb-8">0.00 CW</h1>
            <div id="ton-box">
                <button onclick="connectTon()" class="w-full bg-[#0088cc] text-white py-4 rounded-2xl font-bold shadow-lg flex items-center justify-center gap-2">
                    <img src="https://ton.org/download/ton_symbol.png" class="w-5 h-5 brightness-200"> TON CONNECT
                </button>
            </div>
        </div>
    </div>

    <div id="tasks-page" class="page px-5 pt-4">
        <h2 class="text-white font-black text-2xl mb-4">Daily Tasks âœ…</h2>
        <div class="bg-white/10 rounded-2xl p-4 border border-white/20 flex items-center justify-between mb-2">
            <div><p class="text-white font-bold text-sm">Follow Twitter</p><p class="text-blue-200 text-[10px]">+5 â¤ï¸ Hearts</p></div>
            <button class="bg-blue-500 text-white px-4 py-1.5 rounded-lg font-bold text-xs">GO</button>
        </div>
    </div>

    <div class="city-layer"></div>
    <div class="ground-animated"></div>

    <div class="h-[75px] bg-white border-t border-gray-100 flex justify-around items-center z-[1000] relative">
        <button onclick="changePage('flappy', this)" class="nav-item active flex flex-col items-center gap-1 text-blue-500">
            <span class="text-2xl">ğŸ®</span><span class="text-[9px] font-black uppercase">Flappy</span>
        </button>
        <button onclick="changePage('rating', this)" class="nav-item flex flex-col items-center gap-1 text-gray-400">
            <span class="text-2xl">ğŸ†</span><span class="text-[9px] font-black uppercase">Rating</span>
        </button>
        <button onclick="changePage('friends', this)" class="nav-item flex flex-col items-center gap-1 text-gray-400">
            <span class="text-2xl">ğŸ‘¥</span><span class="text-[9px] font-black uppercase">Friends</span>
        </button>
        <button onclick="changePage('wallet', this)" class="nav-item flex flex-col items-center gap-1 text-gray-400">
            <span class="text-2xl">ğŸ’°</span><span class="text-[9px] font-black uppercase">Wallet</span>
        </button>
        <button onclick="changePage('tasks', this)" class="nav-item flex flex-col items-center gap-1 text-gray-400">
            <span class="text-2xl">âœ…</span><span class="text-[9px] font-black uppercase">Tasks</span>
        </button>
    </div>
</div>

<script>
    // --- SKOR VE VERÄ° SÄ°STEMÄ° ---
    let hearts = 10;
    let dailyBest = 0;
    let allTimeBest = 0;
    let tonAddr = localStorage.getItem('ton_address');

    // --- SEKME YÃ–NETÄ°MÄ° ---
    function changePage(pageId, btn) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(pageId + '-page').classList.add('active');
        if(btn) {
            document.querySelectorAll('.nav-item').forEach(b => b.classList.replace('text-blue-500', 'text-gray-400'));
            btn.classList.replace('text-gray-400', 'text-blue-500');
        }
    }

    // --- TON BAÄLAMA ---
    function connectTon() {
        const addr = prompt("TON Wallet Adresinizi Girin (UQ...):");
        if(addr && addr.length > 20) {
            localStorage.setItem('ton_address', addr);
            tonAddr = addr;
            updateWalletUI();
        }
    }

    function updateWalletUI() {
        if(tonAddr) {
            document.getElementById('ton-box').innerHTML = `
                <div class="bg-gray-100 p-3 rounded-xl border border-blue-200">
                    <p class="text-[9px] text-blue-500 font-black uppercase mb-1">Linked Wallet</p>
                    <p class="text-[9px] font-mono break-all text-gray-600">${tonAddr}</p>
                </div>`;
        }
    }
    updateWalletUI();

    // --- OYUN MOTORU ---
    const canvas = document.getElementById('game-canvas');
    const ctx = canvas.getContext('2d');
    let gameReq;
    let score = 0;
    let pipes = [];

    canvas.width = window.innerWidth > 450 ? 450 : window.innerWidth;
    canvas.height = window.innerHeight - 75;

    const bird = { x: 60, y: 300, w: 34, h: 26, v: 0, g: 0.22, j: 4.8 };

    function resetGame() {
        score = 0; pipes = []; bird.y = 300; bird.v = 0;
        document.getElementById('live-score').innerText = "0";
    }

    function draw() {
        ctx.fillStyle = "#70c5ce";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        bird.v += bird.g; bird.y += bird.v;
        ctx.fillStyle = "#9c5c3c";
        ctx.fillRect(bird.x, bird.y, bird.w, bird.h);
        ctx.strokeRect(bird.x, bird.y, bird.w, bird.h);

        if(pipes.length === 0 || pipes[pipes.length-1].x < canvas.width - 200) {
            pipes.push({ x: canvas.width, y: Math.random() * (canvas.height - 250) + 50, gap: 150, passed: false });
        }

        pipes.forEach(p => {
            p.x -= 3;
            ctx.fillStyle = "#2ecc71";
            ctx.fillRect(p.x, 0, 55, p.y);
            ctx.fillRect(p.x, p.y + p.gap, 55, canvas.height);

            // Ã‡arpÄ±ÅŸma
            if(bird.x + bird.w > p.x && bird.x < p.x + 55 && (bird.y < p.y || bird.y + bird.h > p.y + p.gap)) gameOver();
            // Skor
            if(!p.passed && p.x < bird.x) { p.passed = true; score++; document.getElementById('live-score').innerText = score; }
        });

        if(bird.y + bird.h > canvas.height || bird.y < 0) gameOver();
        pipes = pipes.filter(p => p.x > -60);
        gameReq = requestAnimationFrame(draw);
    }

    function gameOver() {
        cancelAnimationFrame(gameReq);
        hearts--;
        document.getElementById('heart-val').innerText = hearts;
        if(score > dailyBest) dailyBest = score;
        if(score > allTimeBest) allTimeBest = score;
        
        document.getElementById('daily-ui').innerText = dailyBest.toFixed(2);
        document.getElementById('record-ui').innerText = allTimeBest.toFixed(2);

        alert("Game Over! Score: " + score);
        document.getElementById('game-ui').style.display = 'none';
    }

    document.getElementById('play-btn').addEventListener('click', () => {
        if(hearts <= 0) return alert("HakkÄ±n bitti!");
        resetGame();
        document.getElementById('game-ui').style.display = 'block';
        document.getElementById('game-canvas').style.display = 'block';
        draw();
    });

    window.addEventListener('touchstart', (e) => { 
        if(document.getElementById('game-ui').style.display === 'block') {
            e.preventDefault(); bird.v = -bird.j; 
        }
    });
</script>
</body>
</html>

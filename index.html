<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spider-Cash: Referral Edition</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <script src="https://adexora.com/cdn/ads.js?id=1545"></script>

    <style>
        :root { --spidey-red: #e62117; --spidey-blue: #001d4a; --spidey-dark: #0a0a0a; --text: #fff; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--spidey-dark); color: var(--text); display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        .tab-content { flex: 1; display: none; flex-direction: column; align-items: center; justify-content: center; padding: 20px; text-align: center; }
        .active-tab { display: flex; animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .card { background: rgba(255, 255, 255, 0.05); border: 1px solid var(--spidey-red); border-radius: 20px; padding: 20px; width: 90%; max-width: 360px; box-shadow: 0 0 20px rgba(230, 33, 23, 0.2); }
        #emoji { font-size: 100px; cursor: pointer; transition: 0.1s; margin: 20px 0; user-select: none; }
        #emoji:active { transform: scale(0.8); }

        .nav-bar { background: #111; display: flex; border-top: 2px solid var(--spidey-red); padding: 10px 0; }
        .nav-item { flex: 1; text-align: center; cursor: pointer; color: #666; font-size: 12px; }
        .nav-item.active { color: var(--spidey-red); }

        input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #333; background: #000; color: #fff; }
        button { width: 100%; padding: 12px; border: none; border-radius: 8px; background: var(--spidey-red); color: white; font-weight: bold; cursor: pointer; }
        .ref-box { background: #1a1a1a; padding: 10px; border-radius: 8px; font-size: 11px; margin-top: 10px; word-break: break-all; border: 1px dashed #555; }
    </style>
</head>
<body>

    <div id="tab-earn" class="tab-content active-tab">
        <div class="card">
            <small>TOPLAM GÃœÃ‡</small>
            <div style="font-size: 32px; font-weight: 900; color: var(--spidey-red);">$<span id="bal">0.00000</span></div>
        </div>
        <div id="emoji">ğŸ•·ï¸</div>
        <p>AÄŸ limitine: <b id="ad-count">10</b> tÄ±k</p>
    </div>

    <div id="tab-ref" class="tab-content">
        <h2>ArkadaÅŸlarÄ±nÄ± Davet Et</h2>
        <div class="card">
            <p>Her arkadaÅŸÄ±nÄ±n tÄ±klamasÄ±ndan <b>$0.000005</b> bonus kazan!</p>
            <div class="ref-box" id="ref-link">YÃ¼kleniyor...</div>
            <button onclick="copyRef()" style="margin-top:10px; background: #444;">Linki Kopyala</button>
            <hr style="margin: 20px 0; border: 0; border-top: 1px solid #333;">
            <p>Toplam ReferansÄ±n: <b id="ref-total">0</b></p>
        </div>
    </div>

    <div id="tab-wallet" class="tab-content">
        <div class="card">
            <h2>Ã–deme</h2>
            <input type="number" id="amt" placeholder="Miktar (Min $0.50)">
            <input type="text" id="adr" placeholder="USDT (TRC20) Adresi">
            <button id="btn-pay" onclick="sendPay()" disabled>Ã–deme Al</button>
        </div>
    </div>

    <div class="nav-bar">
        <div class="nav-item active" onclick="showTab('earn', this)"><span>ğŸ•¸ï¸</span><br>Kazan</div>
        <div class="nav-item" onclick="showTab('ref', this)"><span>ğŸ‘¥</span><br>Referans</div>
        <div class="nav-item" onclick="showTab('wallet', this)"><span>ğŸ’³</span><br>CÃ¼zdan</div>
    </div>

    <script>
        // FIREBASE CONFIG
        const firebaseConfig = {
            apiKey: "API_KEY",
            authDomain: "PROJECT.firebaseapp.com",
            databaseURL: "https://PROJECT.firebaseio.com",
            projectId: "PROJECT",
            appId: "APP_ID"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // KULLANICI AYARLARI
        let myId = localStorage.getItem('spidey_uid') || "u" + Math.floor(Math.random()*999999);
        localStorage.setItem('spidey_uid', myId);

        // URL'den REFERANS KONTROLÃœ
        const urlParams = new URLSearchParams(window.location.search);
        const refBy = urlParams.get('ref');

        let balance = 0;
        let adStep = 0;
        let myReferrer = "";

        // REFERANS LÄ°NKÄ°NÄ° OLUÅTUR
        const currentUrl = window.location.href.split('?')[0];
        document.getElementById('ref-link').innerText = currentUrl + "?ref=" + myId;

        // VERÄ°LERÄ° BAÅLAT
        db.ref('users/' + myId).once('value', s => {
            if(!s.exists()) {
                db.ref('users/' + myId).set({ balance: 0, refBy: refBy || "", refsCount: 0 });
            } else {
                myReferrer = s.val().refBy;
            }
        });

        db.ref('users/' + myId).on('value', s => {
            if(s.val()) {
                balance = s.val().balance;
                document.getElementById('bal').innerText = balance.toFixed(5);
                document.getElementById('ref-total').innerText = s.val().refsCount || 0;
                checkPay();
            }
        });

        // TIKLAMA MANTIÄI
        document.getElementById('emoji').addEventListener('click', () => {
            adStep++;
            let req = 10 + (Math.floor(balance / 0.01) * 15);
            if(adStep >= req) {
                adStep = 0;
                if(window.showAdexora) window.showAdexora().then(() => addMoney());
                else addMoney();
            } else {
                addMoney();
            }
            document.getElementById('ad-count').innerText = req - adStep;
        });

        function addMoney() {
            balance += 0.00001;
            db.ref('users/' + myId).update({ balance: balance });

            // REFERANSINA PARA KAZANDIR
            if(myReferrer) {
                db.ref('users/' + myReferrer).transaction(user => {
                    if(user) {
                        user.balance = (user.balance || 0) + 0.000005;
                    }
                    return user;
                });
            }
        }

        // DÄ°ÄER FONKSÄ°YONLAR
        function showTab(t, el) {
            document.querySelectorAll('.tab-content').forEach(x => x.classList.remove('active-tab'));
            document.querySelectorAll('.nav-item').forEach(x => x.classList.remove('active'));
            document.getElementById('tab-'+t).classList.add('active-tab');
            el.classList.add('active');
        }

        function copyRef() {
            const link = document.getElementById('ref-link').innerText;
            navigator.clipboard.writeText(link);
            alert("Referans linkin kopyalandÄ±!");
        }

        function checkPay() {
            document.getElementById('btn-pay').disabled = balance < 0.50;
        }

        function sendPay() {
            const a = document.getElementById('amt').value;
            const ad = document.getElementById('adr').value;
            if(a > balance || a < 0.50) return alert("HatalÄ± miktar!");
            db.ref('withdrawals').push({ uid: myId, amount: a, address: ad, date: Date.now() });
            db.ref('users/' + myId).update({ balance: balance - a });
            alert("Talep iletildi!");
        }
    </script>
</body>
</html>
